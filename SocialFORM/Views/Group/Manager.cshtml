@model IEnumerable<SocialFORM.Models.Group.GroupModel>
@{
    ViewBag.Title = "Manager";
}

<style>
    div.title {
        padding: 20px;
        border: 5px inset #008dd2;
        background-color: #ffffff;
        text-align: center;
        font-size: 30px;
        font-family: 'Century Gothic';
        font-weight: 900;
        color: #008dd2;
    }

    .tablenav td {
        background: #57ccff;
        border: 1px solid black;
        height: 50px;
        width: auto;
        padding: 10px
    }

    ul.ul-treefree {
        padding-left: 25px;
    }

        ul.ul-treefree ul {
            margin: 0;
            padding-left: 6px;
        }

        ul.ul-treefree li {
            position: relative;
            list-style: none outside none;
            border-left: solid 1px #999;
            margin: 0;
            padding: 0 0 0 19px;
            line-height: 23px;
        }

            ul.ul-treefree li:before {
                content: '';
                display: block;
                border-bottom: solid 1px #999;
                position: absolute;
                width: 18px;
                height: 11px;
                left: 0;
                top: 0;
            }

            ul.ul-treefree li:last-child {
                border-left: 0 none;
            }

                ul.ul-treefree li:last-child:before {
                    border-left: solid 1px #999;
                }

    ul.ul-dropfree div.drop {
        width: 11px;
        height: 11px;
        position: absolute;
        z-index: 10;
        top: 6px;
        left: -6px;
        background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAALCAIAAAD0nuopAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAE1JREFUeNpinDlzJgNlgAWI09LScEnPmjWLoAImrHpIAkwMFAMqGMGC6X44GzkIsHoQooAFTTVQKdbAwxOigyMsmIh3MC7ASHnqBAgwAD4CGeOiDhXRAAAAAElFTkSuQmCC');
        background-position: -11px 0;
        background-repeat: no-repeat;
        cursor: pointer;
    }

    #modal_form {
        width: 300px;
        height: 300px; /* Рaзмеры дoлжны быть фиксирoвaны */
        border-radius: 5px;
        border: 3px #000 solid;
        background: #fff;
        position: fixed; /* чтoбы oкнo былo в видимoй зoне в любoм месте */
        top: 45%; /* oтступaем сверху 45%, oстaльные 5% пoдвинет скрипт */
        left: 50%; /* пoлoвинa экрaнa слевa */
        margin-top: -150px;
        margin-left: -150px; /* тут вся мaгия центрoвки css, oтступaем влевo и вверх минус пoлoвину ширины и высoты сooтветственнo =) */
        display: none; /* в oбычнoм сoстoянии oкнa не дoлжнo быть */
        opacity: 0; /* пoлнoстью прoзрaчнo для aнимирoвaния */
        z-index: 5; /* oкнo дoлжнo быть нaибoлее бoльшем слoе */
        padding: 20px 10px;
    }
        /* Кнoпкa зaкрыть для тех ктo в тaнке) */
        #modal_form #modal_close {
            width: 21px;
            height: 21px;
            position: absolute;
            top: 10px;
            right: 10px;
            cursor: pointer;
            display: block;
        }
    /* Пoдлoжкa */
    #overlay {
        z-index: 3; /* пoдлoжкa дoлжнa быть выше слoев элементoв сaйтa, нo ниже слoя мoдaльнoгo oкнa */
        position: fixed; /* всегдa перекрывaет весь сaйт */
        background-color: #000; /* чернaя */
        opacity: 0.8; /* нo немнoгo прoзрaчнa */
        -moz-opacity: 0.8; /* фикс прозрачности для старых браузеров */
        filter: alpha(opacity=80);
        width: 100%;
        height: 100%; /* рaзмерoм вo весь экрaн */
        top: 0; /* сверху и слевa 0, oбязaтельные свoйствa! */
        left: 0;
        cursor: pointer;
        display: none; /* в oбычнoм сoстoянии её нет) */
    }

    .emptySpace {
        border: 2px dotted blue;
        width: 100px;
        height: 20px;
    }

    .group_element {
        /*border: 1px solid red;*/
    }

    .HiddenPanelQuota {
        display: none;
        position: fixed;
        width: 80%;
        height: 80%;
        left: 10%;
        top: 10%;
        background-color: white;
        border: 10px inset #008dd2;
        z-index: 999;
        overflow: auto;
        box-shadow: 10px 10px 20px black;
    }

    .ButtonClose {
        display: none;
        position: fixed;
        width: 30px;
        height: 30px;
        left: calc(90% - 15px);
        top: calc(10% - 15px);
        background-color: #e57373;
        border: 5px outset #f44336;
        border-radius: 15px;
        text-align: center;
        z-index: 1000;
        cursor: pointer;
    }

    .BlockWall {
        position: fixed;
        display: none;
        width: 100%;
        height: 100%;
        top: 0;
        left: 0;
        background-color: grey;
        opacity: 0.5;
    }

    @@media screen and (max-width: 768px) {
        .iconMenu {
            width: 60px;
            height: 60px;
        }

        li {
            display: inline;
        }

        .TMP {
            display: inline-flex;
        }
    }
</style>
<link rel="stylesheet" href="~/Content/ManagerStyle.css" />
<link rel="stylesheet" href="~/Scripts/minified/themes/square.min.css" />
<div class="title">@ViewBag.ProjectName</div>

@*<input type="hidden" name="project_id" value="@ViewBag.ProjectID" />
    <div>
        <table cellpadding="4" width="100%" height="100%">
            <tr>
                <td colspan="2">
                    <div id="panel">
                        <button class="menu_panel" id="add_question">Добавить вопрос</button>
                        <button onclick="AddNewGroup()">Добавить группу</button>
                        <button onclick="DeleteGroup()">Удалить группу</button>
                        <button onclick="ShowQuotaPanel()">Квоты</button>
                        <button onclick="ShowLoopPanel()">Циклы</button>
                        <button onclick="ShowBaseAnswerPanel()">Базовые вопросы</button>
                        <button class="menu_panel">Удалить группу</button>
                    </div>
                </td>
            </tr>
            <tr style="resize: none;">
                <td width="25%" style="vertical-align: top;">
                    <div class="drop">
                        @ViewBag.ProjectName
                        @*/   <ul class="ul-treefree ul-dropfree tree_view">
                            //      @Html.Partial("_TreeList", Model.ToList())
                            //  </ul>
                    </div>
                </td>
                <td width="75%">
                    <div style="min-width: 100%; min-height: 100%; position: relative;" class="editor">

                    </div>
                </td>
            </tr>
            <tr>
                <td align="right" colspan="2"></td>
            </tr>
        </table>
    </div>

    <div id="modal_form">
        <!-- Сaмo oкнo -->
        <span id="modal_close">X</span> <!-- Кнoпкa зaкрыть -->
        <!-- Тут любoе сoдержимoе -->
        <div style="padding: 15px; padding-top: 25px;">
            <span>Выберите группу</span>
            <select class="list_group">

                @foreach (var item in Model.Where(u => u.Group != null))
                {
                    if (@item.GroupName == null)
                    {
                        <option value="@item.Group">Группа 0</option>
                    }
                    else
                    {
                        <option value="@item.Group">@item.GroupName</option>
                    }
                }
            </select>
            <br />
            <button class="add_group">Добавить</button>
        </div>
    </div>*@
<div id="overlay"></div><!-- Пoдлoжкa -->
<div class="ButtonClose" onclick="CloseClick()">&#10006;</div>
<div class="HiddenPanelQuota"></div>
<div class="BlockWall"></div>
<div name="ProjectInfo">
    <input type="hidden" name="project_id" value="@ViewBag.ProjectID" />
</div>
<button onclick="Reload()">Обновить</button>
<button onclick="HideAll()">Скрыть все</button>
<button onclick="ShowAll()">Показать все</button>
<div class="NewBlockQuestions sortable-ul"></div>

<div class="BlockQuestionEditor"></div>
<div class="SettingsProject" style="width: 100%; height: 50px; top: 100%; left: 0; background-color: #008dd2; position: fixed; z-index: 99; padding-left: 60px; display: inline-flex">
    <div class="ItemPanelProject AddQuestionInProject">Добавить вопрос</div>
    <div class="ItemPanelProject AddGroupInProject">Добавить группу</div>
    <div class="ItemPanelProject DeleteGroupInProject">Удалить группу</div>
    <div class="ItemPanelProject ShowQuotaPanel">Квоты</div>
    <div class="ItemPanelProject ShowBaseAnswerPanel">Базовые ответы</div>
   
</div>
<div style="width: 50px; height: 50px; position: fixed; top: calc(100vh - 50px); left: 0; background-color: #008dd2; z-index: 100;" class="SlideSettings">&#9650;</div>

@Scripts.Render("~/Scripts/jquery-1.10.2.js")
<script src="~/Scripts/jquery-ui.js" type="text/javascript"></script>
<script src="~/Scripts/minified/sceditor.min.js"></script>
<script src="~/Scripts/minified/formats/xhtml.js"></script>
<script src="~/Scripts/minified/icons/monocons.js"></script>
<style>
    .SlideSettings {
        display: flex;
        justify-content: center;
        align-content: space-between;
        align-items: center;
        flex-direction: column;
        font-size: 24px;
    }

    .MoveOn {
        transform: scale(1, -1);
        box-shadow: 2px 0px 1px black;
        transition: .5s linear;
    }

    .MoveOff {
        transform: scale(1, 1);
        box-shadow: 0 0 black;
        transition: .5s linear;
    }

    .MoveUp {
        transform: translateY(-5px);
        z-index: 50;
        box-shadow: 0px -3px #008dd2;
        transition: .2s linear;
    }

    .MoveDown {
        transform: translateY(0px);
        box-shadow: 0px 0px black;
        transition: .2s linear;
    }

    .NewClass:hover {
        cursor: pointer;
        transform: scale(1.01,1.01);
        transition: 0.1s linear;
        background: linear-gradient(90deg,rgba(111,190,230,1) 0%, rgba(255,255,255,1) 100%) !important;
    }
</style>
<script src="~/Scripts/export2Doc.js"></script>
<script src="~/Scripts/ManagerProject.js"></script>
<script type="text/javascript">

    function Reload() {
        var project_id = $('input[name=project_id]').val();

        $('.Tables').load("/Group/Manager?id_project=" + project_id);
    }

    let pool_data = {};
    let list_base_answer = {};
    $('.SlideSettings').click(function () {
        var tmp = window.innerHeight;
        if ($(this).hasClass("MoveOn")) {
            $('.SettingsProject').animate({ top: tmp + "px" }, 500);
            $(this).addClass("MoveOff").removeClass("MoveOn");
        } else {
            $('.SettingsProject').animate({ top: (tmp - 50) + "px" }, 500);
            $(this).addClass("MoveOn").removeClass("MoveOff");
        }
        })
    var is_loaded = false;
    var list_answer_base;

    ////New BLOCK
    let list_question = [];

    function sortFn(a, b) {
        return a.IndexQuestion - b.IndexQuestion;
    }

    $.get("/Group/getGroup", { id_p: $('div[name=ProjectInfo]').find('input[name=project_id]').val() })
        .success(function (server_data) {
            $.each(server_data, function (i, item) {
                console.log("Log ---- ", item);
                if (item.Group == null) {
                    var code = "<div class='NewClass MainItem' style='width: 100%; height: 30px; background:linear-gradient(90deg, rgba(255,255,255,1) 0%, rgba(111,190,230,1) 100%); border-bottom: 1px solid black; border-right:1px solid black; margin: 1px; display: inline-flex;'>" +
                        "<div style='width:30px;height:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;'>" +
                        "<div style='width:20px;height:20px;background-color:#008dd2;' class='handler'></div>" +
                        "</div>" +
                        "<div class='ShowPanelQuestion' style='width:100%;height:80%;margin:2px;' id='" + item.QuestionID + "'><div>" + item.GroupName +
                        "</div><textarea class='QuestionObject' hidden>" + JSON.stringify(item) + "</textarea>" +
                        "</div>" +
                        "<div style='width:30px;height:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;'>" +
                        "<div class='DeleteQuestion' style='width:20px;height:20px;background-color:#f44336;text-align:center;'>&#10006;</div>" +
                        "</div>" +
                        "</div>";
                    if (item.GroupID == 0)
                        $('.NewBlockQuestions').append(code);
                    else {
                        $('.NewBlockQuestions').find('.ShowPanelGroupText').filter('#' + item.GroupID).parents('.NewGroup').find('.BlockQuestionGroup').append(code);
                    }
                } else { 
                    $('.NewBlockQuestions').append("<div class='NewGroup MainItem' style='width: 100%; height: auto; background:linear-gradient(90deg, rgba(255,255,255,1) 0%, rgba(50,50,50,1) 100%); border-bottom: 1px solid black; border-right:1px solid black; margin: 1px; display: block;'>" +
                        "<div style='display: flex;'>"+
                        "<div style='width:30px;height:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;'>" +
                        "<div style='width:20px;height:20px;background-color:#008dd2;' class='handler'></div>" +
                        "</div>" +
                        "<div class='ShowPanelGroupText' style='width:100%;height:80%;margin:2px;' id='" + item.Group + "'>" + item.GroupName +
                        "<textarea class='QuestionObject' hidden></textarea>" +
                        "</div>" +
                        "</div>" +
                        "<div class='BlockQuestionGroup sortable-ul' style='height:auto; width:100%; background-color:#81c784; display: block; padding-left: 50px;'></div>" +
                        "</div>");
                }
            })
            $('.PreLoader').hide();
            EnableSortable();       
        })

    function EnableSortable() {
        $('.NewBlockQuestions').sortable({
            start: function (event, ui) {
                $('.NewBlockQuestions').find('.BlockQuestionGroup').each(function () {
                    if ($(this).html() == "") {
                        $(this).css("height", "30px");
                    }
                })
            },
            stop: function (event, ui) {
                $('.NewBlockQuestions').find('.BlockQuestionGroup').css("height", "auto");

                if (ui.item.parent().hasClass('BlockQuestionGroup')) {
                    if (ui.item.hasClass('NewGroup')) {
                        $('.NewBlockQuestions').sortable("cancel");
                    } else {
                        $.post("/Group/ChangeGroup", { id_q: ui.item.find('.ShowPanelQuestion').attr('id'), id_g: ui.item.parents('.NewGroup').find('.ShowPanelGroupText').attr('id') });
                    }
                }
                ChangeIndexQuestion();
            },
            handle: '.handler',
            placeholder: 'emptySpace',
            connectWith: '.BlockQuestionGroup'
        });
        $('.BlockQuestionGroup').sortable({
            stop: function (event, ui) {
                if (ui.item.parent().hasClass('NewBlockQuestions')) {
                    $.post("/Group/ChangeGroup", { id_q: ui.item.find('.ShowPanelQuestion').attr('id'), id_g: 0 });
                }
            },
            connectWith: '.NewBlockQuestions'
        });
    }

    $('.NewBlockQuestions').on("click", ".ShowPanelQuestion", function () {
        $('.NewBlockQuestions').append("<div class='PanelQuestion' style='position:fixed;width: 100%; height: 100%;top:0; left:0; background-color: rgba(100,100,100,0.5);z-index:3000;'>" +
            "<div class='AddAnswer' style='position:absolute; width:80%;height:80%;top:10%;left:10%;background-color:#008bb2;'>" +
            "<div style='width:100%; height: 40px; background: linear-gradient(180deg, rgba(255,255,255,1) 0%, rgba(0,139,178,1) 60%); display: inline-flex;'>" +
            "<div style='width: 100%;'></div>"+
            "<div class='ClosePanelQuestion' style='width:40px;height:100%;background-color:red; cursor:pointer;display:flex;flex-direction:column;justify-content:center;align-items:center;'><div>&#10006;</div></div>"+
            "</div>" +
            "<div class='AddAnswerBlock' style='width:100%;height:100%;background-color:#008bb2;overflow: auto;'></div>" +
            "</div>" +
            "</div>"
        );
        //alert($(this).find('textarea.QuestionObject').text());
        var panel_item = $(this);
        $.when(SetQuestionBlock($('.AddAnswerBlock'), panel_item.find('textarea.QuestionObject').text() != ""?JSON.parse($(this).find('textarea.QuestionObject').text()):null))
            .then(function () {
                var text = $('.PanelQuestion').find('textarea#example');
                $.each(text, function (i, item) {
                    item.textContent = "war";
                    sceditor.create(item, {
                        resizeEnabled: false,
                        format: 'xhtml',
                        icons: 'monocons',
                        style: '/Scripts/minified/themes/content/default.min.css',
                        toolbar: 'bold,italic,underline|left,center,right,justify|font,size,color,removeformat|code,quote,horizontalrule|source,maximize'
                    });
                    SetQuestionNew(item, item.parentElement.getAttribute('id'), panel_item.find('textarea.QuestionObject').text() != ""?JSON.parse(panel_item.find('textarea.QuestionObject').text()) : null);
                    // SetAnswer(item.parentElement.getAttribute('id'));
                })
            });
      //  SetAnswerNew($(this).attr('id'), $('.AddAnswer'));
    })

    $('.NewBlockQuestions').on("click", ".ClosePanelQuestion", function () {
        $('.NewBlockQuestions').find('.PanelQuestion').remove();
    })

    {
        //$.get("/Group/getGroup", { id_p: $('div[name=ProjectInfo]').find('input[name=project_id]').val() })
        //    .success(function (server_data) {
        //        $.get("/Question/getAnswerBase")
        //            .success(function (base_data) {
        //                $.each(base_data, function (i, b_item) {
        //                    list_base[b_item.Id] = b_item;
        //                })
        //            })
        //        var panel_editor = $('.BlockQuestionEditor');
        //        $.each(server_data, function (i, item) {
        //            if (item.Group == null) {
        //                list_question.push(item);
        //                var id_question = item.QuestionID;
        //                if (item.GroupID == 0) {
        //                    panel_editor.append("<div class='QuestionBlock sortable MainItem' id='" + item.IndexQuestion + "'><div name='QuestionInfo' style='display: none'>" +
        //                        "<input name='groupInfo' type='hidden' value='" + item.Id + "' />" +
        //                        "<input name='questionInfo' type='hidden' value='" + item.QuestionID + "'/>" +
        //                        "</div>" +
        //                        "<div class='ShortNameQuestion'><div style='width: 100%;'>" + item.GroupName + "</div><div class='EditAnswer'>&#9000;</div><div class='DeleteQuestion' style='color: #fff;'>	&#10006;</div><button class='hidePanel' style='display: inline-flex'>hide</button></div>" +
        //                        "<div class='QuestionText HideOff' id='" + item.QuestionID + "'><textarea id='example' style='width: 80 %; height: 300px; display: none;'></textarea></div>" +
        //                        "<div class='SettingsPanel'><div class='NameType'>Type</div><div class='WallOfTypes' style='position: relative; z - index: 5; height: 30px; width: 30px'>></div></div>" +
        //                        "<div class='AnswerBlock HideOff' style='overflow-y: auto;'><div class='AnswerSettings'>" +
        //                        "</div><div class='PanelSettings'></div></div>" +
        //                        "<div class='SaveChange'><div class='SaveChangeButton'>Save</div></div></div>"
        //                    );
        //                } else {
        //                    if (panel_editor.find(".Group[id=" + item.GroupID + "]").length == 0) {
        //                        panel_editor.append("<div class='Group MainItem' id='" + item.GroupID + "' style='width: 100%; height: auto; padding: 5px; background-color: #81c784; margin-bottom: 5px;'><div class='ui-state-disabled'>Группа " + item.GroupID + "</div></div>")
        //                    }
        //                    panel_editor.find(".Group[id="+item.GroupID+"]").append("<div class='QuestionBlock sortable' id='" + item.IndexQuestion + "'><div name='QuestionInfo' style='display: none'>" +
        //                        "<input name='groupInfo' type='hidden' value='" + item.Id + "' />" +
        //                        "<input name='questionInfo' type='hidden' value='" + item.QuestionID + "'/>" +
        //                        "</div>" +
        //                        "<div class='ShortNameQuestion'><div style='width: 100%;'>" + item.GroupName + "</div><div class='EditAnswer'>&#9000;</div><div class='DeleteQuestion' style='color: #fff;'>	&#10006;</div><button class='hidePanel' style='display: inline-flex'>hide</button></div>" +
        //                        "<div class='QuestionText HideOff' id='" + item.QuestionID + "'><textarea id='example' style='width: 80 %; height: 300px; display: none;'></textarea></div>" +
        //                        "<div class='SettingsPanel'><div class='NameType'>Type</div><div class='WallOfTypes' style='position: relative; z - index: 5; height: 30px; width: 30px'>></div></div>" +
        //                        "<div class='AnswerBlock HideOff' style='overflow-y: auto;'><div class='AnswerSettings'>" +
        //                        "</div><div class='PanelSettings'></div></div>" +
        //                        "<div class='SaveChange'><div class='SaveChangeButton'>Save</div></div></div>"
        //                    );
        //                }
        //            } else {
        //                if (panel_editor.find(".Group[id=" + item.Group + "]").length == 0)
        //                    panel_editor.append("<div class='Group MainItem' id='" + item.Group + "' style='width: 100%; height: auto; padding: 5px; background-color: #81c784; margin-bottom: 5px;'><div class='ui-state-disabled'>Группа "+item.Group+"</div></div>")
        //            }
        //        })
        //        FindTextArea();
        //    })

        //function SetQuestion(item, parent) {
        //    $.get("/Question/getQuestion", { id: parent })
        //        .success(function (q_data) {
        //            var question_block = $('.QuestionText[id=' + parent + ']').parents(".QuestionBlock");
        //            sceditor.instance(item).val(q_data.TextQuestion);
        //            question_block.find("div[name=QuestionInfo]").append('<input name="questionType" type="hidden" value="' + q_data.TypeQuestion + '">');
        //            switch (q_data.TypeQuestion) {
        //                case 1:
        //                    question_block.find('.NameType').text('Single');
        //                    break;
        //                case 2:
        //                    question_block.find('.NameType').text('Multi');
        //                    break;
        //                case 3:
        //                    question_block.find('.NameType').text('Free');
        //                    break;
        //                case 4:
        //                    question_block.find('.NameType').text('Table');
        //                    break;
        //                case 5:
        //                    question_block.find('.NameType').text('Text');
        //                    break;
        //                case 6:
        //                    question_block.find('.NameType').text('Filter');
        //                    break;
        //                default:
        //                    question_block.find('.NameType').text('Other');
        //                    break;
        //            }
        //            SetAnswer(parent, q_data);
        //        })
        //}

        // Функция выгрузки и построения ответов
        //function SetAnswer(id_question, q_data) {
        //    var type_question = $('.BlockQuestionEditor').find('div.QuestionText[id=' + id_question + ']').parent().find('div[name=QuestionInfo]').find('input[name=questionType]').val();
        //    switch (Number(type_question)) {
        //        case 1: {
        //            $.get("/Question/getAnswerAll", { question_id: id_question })
        //                .success(function (answer_all) {
        //                    $.get("/Question/getAnswer", { id_question: id_question })
        //                        .success(function (a_data) {
        //                            var list_answer = {};
        //                            $.each(a_data, function (i, a_item) {
        //                                list_answer[a_item.Id] = a_item;
        //                            })
        //                            var tmp = $('.BlockQuestionEditor').find('div.QuestionText[id=' + id_question + ']').parent().find('div.AnswerBlock');
        //                            $.each(answer_all, function (i, item) {
        //                                console.log("Item --- ", item);
        //                                if (item.AnswerType == 1)
        //                                    tmp.append('<div class="AnswerItem" id=' + item.AnswerKey + '><div style="margin-right: 15px"><input type="radio" disabled/></div><div class="IndexAnswer">' + list_answer[item.AnswerKey].Index + ') </div><div style="width: 70%;" class="TextAnswer">' + list_answer[item.AnswerKey].AnswerText +
        //                                        '</div>' +
        //                                        (item.BindGroup == null ? '<div class="SetBindGroup StyleButton" style="width: 30px; background-color: #81c784; font-size: 20px;">&infin;</div>' : '<div class= "BindGroupPanel" style = "width: 100px; background-color: #81c784;" > Группа ' + item.BindGroup + '<div class= "RemoveBindGroup StyleButton" style = "background-color: #f44336; width: 30px;" >&#10006;</div></div>') +
        //                                        '<div style="width: 5px;"></div>' +
        //                                        '<div class="FreeArea" style="display: inline-flex; width: 20%; height: 100%;"><input type="checkbox" name="FreeAreaCheckbox" ' + (list_answer[item.AnswerKey].isFreeArea ? "checked" : "") + '/>Свободное поле</div>' +
        //                                        '<div class="DeleteAnswerItem">&#10006;</div><div style="width: 5px;"></div><div class="EditAnswer">&#9000;</div>' +
        //                                        '<div style="width: 5px;"></div>' +
        //                                        '<div class="ChangeIndex">ID</div>' +
        //                                        '<div style="width: 5px;"></div>'+
        //                                        '<input type="hidden" name="IndexAnswer" value=' + list_answer[item.AnswerKey].Index + '></div>');
        //                                else
        //                                    tmp.append('<div class="AnswerItem BaseAnswer Existed" id=' + item.Id + '><div style="margin-right: 15px">' +
        //                                        '<input type="radio" disabled/></div><div class="IndexAnswer">' + -1 * Number(list_base[item.AnswerKey].BaseIndex) + ') </div>' +
        //                                        '<div style="width: 100%;" class="TextAnswer">' + list_base[item.AnswerKey].AnswerText + '</div>' +
        //                                        '<div class="DeleteAnswerItem">&#10006;</div></div>');
        //                            })
        //                            LoadSettingsSingle(tmp.find('.AnswerSettings'), q_data);
        //                        })
        //                })
        //        }
        //            break;
        //        case 2: {
        //            $.get("/Question/getAnswerAll", { question_id: id_question })
        //                .success(function (answer_all) {
        //                    $.get("/Question/getAnswer", { id_question: id_question })
        //                        .success(function (a_data) {
        //                            var list_answer = {};
        //                            $.each(a_data, function (i, a_item) {
        //                                list_answer[a_item.Id] = a_item;
        //                            })
        //                            var tmp = $('.BlockQuestionEditor').find('div.QuestionText[id=' + id_question + ']').parent().find('div.AnswerBlock');
        //                            $.each(answer_all, function (i, item) {
        //                                if (item.AnswerType == 1)
        //                                    tmp.append('<div class="AnswerItem" id=' + item.AnswerKey + '><div style="margin-right: 15px"><input type="checkbox" disabled/></div><div class="IndexAnswer">' + list_answer[item.AnswerKey].Index + ') </div><div style="width: 70%;" class="TextAnswer">' + list_answer[item.AnswerKey].AnswerText +
        //                                        '</div>' +
        //                                        (item.BindGroup == null ? '<div class="SetBindGroup StyleButton" style="width: 30px; background-color: #81c784;">&infin;</div>' : '<div class="BindGroupPanel" style="width: 100px; background-color: #81c784;">Группа ' + item.BindGroup + '<div class="RemoveBindGroup StyleButton" style="background-color: #f44336; width: 30px;">&#10006;</div></div>') +
        //                                        '<div style="width: 5px;"></div>' +
        //                                        '<div class="FreeArea" style="display: inline-flex; width: 20%; height: 100%;"><input type="checkbox" name="FreeAreaCheckbox" ' + (list_answer[item.AnswerKey].isFreeArea ? "checked" : "") + '/>Свободное поле</div>' +
        //                                        '<div class="DeleteAnswerItem">&#10006;</div><div style="width: 5px;"></div><div class="EditAnswer">&#9000;</div>' +
        //                                        '<div style="width: 5px;"></div>' +
        //                                        '<div class="ChangeIndex">ID</div>' +
        //                                        '<div style="width: 5px;"></div>' +
        //                                        '<input type="hidden" name="IndexAnswer" value=' + list_answer[item.AnswerKey].Index + '></div>');
        //                                else
        //                                    tmp.append('<div class="AnswerItem BaseAnswer" id=' + item.Id + '><div style="margin-right: 15px"><input type="checkbox" disabled/></div><div class="IndexAnswer">' + -1 * Number(list_base[item.AnswerKey].BaseIndex) + ') </div><div style="width: 100%;" class="TextAnswer">' + list_base[item.AnswerKey].AnswerText + '</div><div class="DeleteAnswerItem">&#10006;</div></div>');
        //                            })
        //                            LoadSettingsMilti(tmp.find('.AnswerSettings'), q_data);
        //                        })
        //                })
        //        }
        //            break;
        //        case 3: {
        //            $.get("/Question/getAnswerAll", { question_id: id_question })
        //                .success(function (answer_all) {
        //                    $.get("/Question/getAnswer", { id_question: id_question })
        //                        .success(function (a_data) {
        //                            var list_answer = {};
        //                            $.each(a_data, function (i, a_item) {
        //                                list_answer[a_item.Id] = a_item;
        //                            })
        //                            var tmp = $('.BlockQuestionEditor').find('div.QuestionText[id=' + id_question + ']').parent().find('div.AnswerBlock');
        //                            $.each(answer_all, function (i, item) {
        //                                if (item.AnswerType == 1)
        //                                    tmp.append('<div class="AnswerItem" id=' + item.AnswerKey + '><div style="margin-right: 15px"><input type="text" placeholder="Текстовый блок" disabled/></div><div style="width: 100%;" class="TextAnswer">' + list_answer[item.AnswerKey].AnswerText +
        //                                        '</div><div class="DeleteAnswerItem">&#10006;</div><div style="width: 5px;"></div><div class="EditAnswer">&#9000;</div>' +
        //                                        '<div style="width: 5px;"></div>' +
        //                                        '<div class="ChangeIndex">ID</div>' +
        //                                        '<div style="width: 5px;"></div>' +
        //                                        '<input type="hidden" name="IndexAnswer" value=' + list_answer[item.AnswerKey].Index + '></div>');
        //                                else
        //                                    tmp.append('<div class="AnswerItem BaseAnswer" id=' + item.Id + '><div style="margin-right: 15px"><input type="checkbox" disabled/></div><div style="width: 100%;">' + list_base[item.AnswerKey].AnswerText + '</div><div class="DeleteAnswerItem">&#10006;</div></div>');
        //                            })
        //                            LoadSettingsFree(tmp.find('.AnswerSettings'), q_data);
        //                        })
        //                })
        //        }
        //            break;
        //        case 4: {
        //            $.get("/Question/getAnswerAll", { question_id: id_question })
        //                .success(function (answer_all) {
        //                    $.get("/Question/getAnswer", { id_question: id_question })
        //                        .success(function (a_data) {
        //                            var list_answer = {};
        //                            $.each(a_data, function (i, a_item) {
        //                                list_answer[a_item.Id] = a_item;
        //                            })
        //                            var tmp = $('.BlockQuestionEditor').find('div.QuestionText[id=' + id_question + ']').parent().find('div.AnswerBlock');
        //                            $.get("/Question/getTableRow", { id_q: id_question, id_a: 0 })
        //                                .success(function (row_data) {
        //                                    if (row_data.length > 0) {
        //                                        var row_length = row_data.length;
        //                                        var column_length = a_data.length;
        //                                        var code = "<div style='position: relative'><div style='overflow-x: scroll; overflow-y: visible; margin-left: 200px;'><table class='TableStyle' style='width: 100%;'>";
        //                                        for (var row_i = 0; row_i <= row_length; row_i++) {
        //                                            if (row_i == 0) {
        //                                                code += "<tr class='AnswerTableLine'>";
        //                                            } else {
        //                                                code += "<tr>";
        //                                            }
        //                                            for (var col_i = 0; col_i <= column_length; col_i++) {
        //                                                if (row_i == 0 && col_i == 0) code += "<td></td>";
        //                                                if (row_i == 0 && col_i > 0) {
        //                                                    code += "<td style='min-width: 200px; max-width: 200px; vertical-align: top;' class='TableColumnText Column" + col_i + "' id=" + col_i + ">" +
        //                                                        "<div style='display: inline-flex; flex-direction: row; width: 100%;'>" +
        //                                                        "<div style='display: inline-flex; width: 100%;' class='TextAnswerDiv' id='" + a_data[(col_i - 1)].Id + "'>" + a_data[(col_i - 1)].AnswerText + "</div>" +
        //                                                        "<div class='PanelColumn' style='display: flex; flex-direction: column; vartical-align: top;'>" +
        //                                                        "<div style='width: 20px; height: 20px; background-color: #f44336;' class='DeleteColumn StyleButton'>&#10006;</div>" +
        //                                                        "<div style='width: 20px; height: 20px; background-color: #f44336;' class='StyleButton EditTextColumn'>&#9000;</div>" +
        //                                                        "</div></div></td>";
        //                                                }
        //                                                if (row_i > 0 & col_i == 0) {
        //                                                    code += "<td style='min-width: 200px; max-width: 200px; position: absolute; left: 0;' class='TableRowText'>" +
        //                                                        "<div style='display: inline-flex; flex-direction: row; width: 100%'>" +
        //                                                        "<div style='display: inline-flex; width: 100%' class='TextTableRowDiv' id='" + row_data[(row_i - 1)].Id + "'>" + row_data[(row_i - 1)].TableRowText + "</div>" +
        //                                                        "<div class='PanelRow' style='display: flex; flex-direction: column'>" +
        //                                                        "<div style='width: 20px; height: 20px; background-color: #f44336;' class='StyleButton DeleteRow'>&#10006;</div>" +
        //                                                        "<div style='width: 20px; height: 20px; background-color: #f44336;' class='StyleButton EditTextRow'>&#9000;</div>" +
        //                                                        "</div></div>" +
        //                                                        "<div class='InputOwnIndex' style='display: inline-flex; width: 100%; background-color: #008dd2;'><div>Индекс</div><input type='text' name='OwnIndex' style='width: 100%;' value='" + row_data[(row_i - 1)].IndexRow + "' /></div>" +
        //                                                        "</td>";
        //                                                }
        //                                                if (row_i > 0 & col_i > 0) code += "<td class='TypeItemTable Column" + col_i + "' id=" + col_i + "><div><input type='radio' disabled></div></td>";
        //                                            }
        //                                            code += "</tr>";
        //                                        }
        //                                        code += "</table></div></div>";
        //                                        tmp.append(code);
        //                                        ResizeItem(tmp);
        //                                    }
        //                                    LoadSettingsTable(tmp.find(".AnswerSettings"), q_data);
        //                                })
        //                        })
        //                })
        //        }
        //            break;
        //        case 6: {
        //            var tmp = $('.BlockQuestionEditor').find('div.QuestionText[id=' + id_question + ']').parent().find('div.AnswerBlock');
        //            LoadSettingsFilter(tmp.find('.AnswerSettings'), q_data);
        //        }
        //            break;
        //        default:
        //            break;
        //    }

        //}

        //function ResizeItem(block) {
        //    var panel = block.find('.TableStyle');
        //    panel.find("tr:not(AnswerTableLine)").each(function () {
        //        var height = $(this).find(".TableRowText").height();
        //        $(this).find(".TypeItemTable").each(function () {
        //            $(this).find("div").css("height", height);
        //        })
        //    })
        //}

        //$('.BlockQuestionEditor').on("click", ".EditTextRow", function () {
        //    $(this).addClass("SaveChangeTextRow").removeClass('EditTextRow');
        //    $(this).css({ "background-color": "#008dd2" });
        //    var block = $(this).parents(".PanelRow").prev();
        //    var str_text = block.text();
        //    block.empty().append('<textarea style="resize: none" name="ChangeTextRow">' + str_text + '</textarea>');
        //})

        //$('.BlockQuestionEditor').on("click", ".EditTextColumn", function () {
        //    $(this).addClass("SaveChangeTextColumn").removeClass('EditTextColumn');
        //    $(this).css({ "background-color": "#008dd2" });
        //    var block = $(this).parents(".PanelColumn").prev();
        //    var str_text = block.text();
        //    block.empty().append('<textarea style="resize: none" name="ChangeTextColumn">' + str_text + '</textarea>');
        //})

        //$('.BlockQuestionEditor').on("click", ".SaveChangeTextRow", function () {
        //    $(this).addClass("EditTextRow").removeClass("SaveChangeTextRow");
        //    $(this).css({ "background-color": "#f44336" })
        //    var block = $(this).parents(".PanelRow").prev();
        //    var str_textarea = block.find("textarea[name=ChangeTextRow]").val();
        //    block.empty().text(str_textarea);
        //    ResizeItem($(this).parents(".AnswerBlock"));
        //})

        //$('.BlockQuestionEditor').on("click", ".SaveChangeTextColumn", function () {
        //    $(this).addClass("EditTextColumn").removeClass("SaveChangeTextColumn");
        //    $(this).css({ "background-color": "#f44336" })
        //    var block = $(this).parents(".PanelColumn").prev();
        //    var str_textarea = block.find("textarea[name=ChangeTextColumn]").val();
        //    block.empty().text(str_textarea);
        //})

        // Функция удаления строк в таблице
        //$('.BlockQuestionEditor').on("click", ".DeleteRow", function () {
        //    var block = $(this).parents(".TableStyle");
        //    var remove_block = $(this);
        //    var id_table_row = Number($(this).parents(".TableRowText").find(".TextTableRowDiv").attr("id"));
        //    if (block.find("tr").length > 2) {
        //        $.post("/Question/DeleteTableRow", { id_table_row: id_table_row })
        //            .success(function () { remove_block.parents("tr").remove(); })
        //    } else {
        //        alert("Ограничение удаления строк");
        //    }
        //})

        // Функция удаления столбцов в таблице
        //$('.BlockQuestionEditor').on("click", ".DeleteColumn", function () {
        //    var block = $(this).parents(".TableStyle");
        //    var item = $(this).parents(".TableColumnText");
        //    var id_answer = item.find("div.TextAnswerDiv").attr("id");
        //    block.find("tr:not(AnswerTableLine)").each(function () {
        //        $(this).find(".TypeItemTable:first").remove();
        //    })
        //    $.post("/Question/deleteAnswer", { Id: id_answer })
        //        .success(function () { })
        //    ResizeItem($(this).parents(".AnswerBlock"));
        //    item.remove();
        //})


        //Установка редактора текста для вопроса
        //function FindTextArea() {
        //    var text = $('.BlockQuestionEditor').find('textarea#example');
        //    $.each(text, function (i, item) {
        //        item.textContent = "war";
        //        sceditor.create(item, {
        //            resizeEnabled: false,
        //            format: 'xhtml',
        //            icons: 'monocons',
        //            style: '/Scripts/minified/themes/content/default.min.css',
        //            toolbar: 'bold,italic,underline|left,center,right,justify|font,size,color,removeformat|code,quote,horizontalrule|source,maximize'
        //        });
        //        SetQuestion(item, item.parentElement.getAttribute('id'));
        //       // SetAnswer(item.parentElement.getAttribute('id'));
        //    })
        //}
    }

    $('body').on("mouseenter", ".StyleButton", function () {
        $(this).addClass('Scaled');
    })

    $('body').on("mouseleave", ".StyleButton", function () {
        $(this).removeClass('Scaled');
    })

    {
        /*
         * Кнопка
         */
        //$('.BlockQuestionEditor').on("click", ".ButtonSlideSettings", function () {
        //    if ($(this).hasClass('ShowSlide')) {
        //        $(this).parents(".AnswerBlock").find('.PanelSettings').slideUp(1000);
        //        $(this).removeClass('ShowSlide');
        //    } else {
        //        $(this).addClass('ShowSlide');
        //        $(this).parents(".AnswerBlock").find('.PanelSettings').slideDown(1000);
        //    }
        //})

        //$('.BlockQuestionEditor').on("click", ".hidePanel", function () {
        //    var tmp = $(this).parents('.QuestionBlock').find('.QuestionText');
        //    var tmp2 = $(this).parents('.QuestionBlock').find('.AnswerBlock');
        //    if (tmp.hasClass('HideOff')) {
        //        tmp.removeClass('HideOff').addClass('HideOn').slideUp(500);
        //        tmp2.removeClass('HideOff').addClass('HideOn').slideUp(500);
        //    } else {
        //        tmp.removeClass('HideOn').addClass('HideOff').slideDown(500);
        //        tmp2.removeClass('HideOn').addClass('HideOff').slideDown(500);
        //    }
        //})

        //function HideAll() {
        //    $('.BlockQuestionEditor').find('.QuestionText').slideUp(500).removeClass("HideOff").addClass("HideOn");
        //    $('.BlockQuestionEditor').find('.AnswerBlock').slideUp(500).removeClass("HideOff").addClass("HideOn");
        //    $('.BlockQuestionEditor').sortable({
        //        stop: function (event, ui) {
        //            var list_id_question = [];
        //            $('.BlockQuestionEditor').find('.QuestionBlock').each(function () {
        //                list_id_question.push(Number($(this).find("div[name=QuestionInfo]").find('input[name=questionInfo]').val()))
        //            })
        //            console.log("New set question ---- ", list_id_question);
        //            if (ui.item.parent().hasClass("Group")) {
        //                var group_id = ui.item.parent().attr('id');
        //                var question_id = ui.item.find("div[name=QuestionInfo]").find('input[name=questionInfo]').val();

        //                $.post("/Group/ChangeGroup", { id_q: question_id, id_g: group_id })
        //                    .success(function () {
        //                        ui.item.removeClass("MainItem");
        //                    })
        //            }
        //            ChangeIndexQuestion();
        //           // $.post("/Group/ChangeIndexQuestion", { new_set: list_id_question, id_p: Number($('div[name=ProjectInfo]').find('input[name=project_id]').val()) });
        //        },
        //        items: '.MainItem', placeholder: 'emptySpace', helper: 'clone', connectWith: '.Group'
        //    });
        //    $('.Group').sortable({
        //        stop: function (event, ui) {
        //            if (ui.item.parent().hasClass("BlockQuestionEditor")) {
        //                var group_id = 0;
        //                var question_id = ui.item.find("div[name=QuestionInfo]").find('input[name=questionInfo]').val();
        //                $.post("/Group/ChangeGroup", { id_q: question_id, id_g: group_id })
        //                    .success(function () {
        //                        ui.item.addClass("MainItem")
        //                    })
        //            }
        //        },
        //        items: '.QuestionBlock', placeholder: 'emptySpace', helper: 'clone', connectWith: '.BlockQuestionEditor'
        //    });
        //}



        //function ChangeIndexQuestion() {
        //    var count = 1;
        //    var count_group = 1;
        //    var list_id_questtion = [];
        //    $('.BlockQuestionEditor').find(".MainItem").each(function () {
        //        if ($(this).hasClass("QuestionBlock")) {
        //            list_id_questtion.push($(this).find("div[name=QuestionInfo]").find('input[name=questionInfo]').val())
        //            $(this).find(".ShortNameQuestion").find("div:first").text("Вопрос " + count);
        //            count++;
        //        } else if ($(this).hasClass("Group")) {
        //            list_id_questtion.push(-1 * Number($(this).attr("id")));
        //            $(this).find("div:first").text("Группа " + count_group++);
        //            $(this).find(".QuestionBlock").each(function () {
        //                list_id_questtion.push($(this).find("div[name=QuestionInfo]").find('input[name=questionInfo]').val());
        //                $(this).find(".ShortNameQuestion").find("div:first").text("Вопрос " + count);
        //                count++;
        //            })
        //        }
        //    })
        //    $.post("/Group/ChangeIndexQuestion", { new_set: list_id_questtion, id_p: $('div[name=ProjectInfo]').find('input[name=project_id]').val() });
        //    console.log("List --- > ", list_id_questtion);
        //}

        //function ShowAll() {
        //    $('.BlockQuestionEditor').find('.QuestionText').slideDown(500).removeClass("HideOn").addClass("HideOff");
        //    $('.BlockQuestionEditor').find('.AnswerBlock').slideDown(500).removeClass("HideOn").addClass("HideOff");
        //}
    }

    function windowHeight() {
        var wh = document.documentElement;
        return self.innerHeight || (wh && wh.clientHeight) || document.body.clientHeight;

    }

    function windowWidth() {
        var ww = document.documentElement;
        return self.innerWidth || (ww && ww.clientWidth) || document.body.clientWidth;
    }

    //Функция удаления вопроса
    $('.NewBlockQuestions').on("click", ".DeleteQuestion", function () {
        var id_question = $(this).parents(".NewClass").find('.ShowPanelQuestion').attr('id');
        var type_question;
        var item_block = $(this).parents(".NewClass");
        console.log("Question ID >>> ", id_question);
        $.ajax({
            method: "GET",
            url: "/Question/getQuestion",
            async: false,
            data: { id: id_question },
            success: function (data) {
                type_question = data.TypeQuestion
            }
        });
        $.post("/Question/deleteQuestion", { id: id_question })
            .success(function () {
                item_block.remove();
                switch (type_question) {
                    case 1: {
                        $.post("/Question/deleteAllTransition", { id_question: id_question });
                        $.post("/Question/deleteAllBlocks", { id_question: id_question });
                    }
                        break;
                    case 2: {
                        $.post("/Question/deleteAllBlocks", { id_question: id_question });
                    }
                        break;
                    case 3: {
                        $.post("/Question/DeletaAllRangeQ", { id_question: id_question });
                    }
                        break;
                    case 4: {
                        $.post("/Question/DeleteAllTableRow", { id_q: id_question });
                    }
                        break;
                    case 6: {
                        $.post("/Group/DeleteFileQuestion", { id_question: id_question });
                    }
                        break;
                    default:
                        break;
                }
            })
    })

    $(".NewBlockQuestions").on("mouseenter", ".DeleteQuestion", function () {
        $(this).addClass('Scaled');
    })

    $(".NewBlockQuestions").on("mouseleave", ".DeleteQuestion", function () {
        $(this).removeClass('Scaled');
    })

    $('.ItemPanelProject').mouseenter(function () {
        $(this).addClass('MoveUp').removeClass('MoveDown');
    })

    $('.ItemPanelProject').mouseleave(function () {
        $(this).addClass('MoveDown').removeClass('MoveUp');
    })

    $('.BlockQuestionEditor').on("mouseenter", ".ButtonType", function () {
        $(this).addClass('Scaled');
    })

    $('.BlockQuestionEditor').on("mouseleave", ".ButtonType", function () {
        $(this).removeClass('Scaled');
    })

    {
    //$('.BlockQuestionEditor').on("click", ".WallOfTypes", function () {
    //    var wall_left = $(this).offset().left;
    //    var wall_top = $(this).offset().top;
    //    var wall_width = $(this).width();
    //    var wall_height = $(this).height();
    //    $(this).css({ position: "absolute", "z-index": 9 });
    //    $(this).animate({ width: 100 }, 100);
    //    $(this).animate({ height: (wall_height + 100) }, 100);
    //    $(this).empty().append('<div class="ButtonType">Single</div><div class="ButtonType">Multi</div><div class="ButtonType">Free</div><div class="ButtonType">Table</div>' +
    //        '<div class="ButtonType">Text</div><div class="ButtonType">Filter</div>');
    //    $(this).removeClass("WallOfTypes").addClass("ChangeWall");
    //    $(document).mouseup(function (event) {
    //        var container = $('.ChangeWall');
    //        if (container.has(event.target).length === 0) {
    //            container.css({ position: "relative", "z-index": 5, height: 30, width: 30 });
    //            container.removeClass("ChangeWall").addClass("WallOfTypes");
    //            container.empty().text(">");
    //        }
    //    });
    //})

    //$('.BlockQuestionEditor').on("click", ".ButtonType", function () {
    //    var string_type = $(this).text();
    //    CheckTypeQuestion(string_type, $(this).parents(".QuestionBlock"));
    //    var wall_height = $(this).parent().height() - 100;
    //    $(this).parent().css({ position: "relative", "z-index": 5, height: wall_height, width: 30 });
    //    $(this).parent().removeClass("ChangeWall").addClass("WallOfTypes");
    //    $(this).parents(".SettingsPanel").find('.NameType').text(string_type);
    //    $(this).parent().empty().text(">");
    //})

    // Функция изменения типа вопроса
    //function CheckTypeQuestion(str_type, q_block) {
    //    var id_question = Number(q_block.find('div[name=QuestionInfo]').find('input[name=questionInfo]').val());
    //    switch (str_type) {
    //        case 'Single': {
    //            var type_question = Number(q_block.find('div[name=QuestionInfo]').find('input[name=questionType]').val());
    //            if (type_question == 3 || type_question == 2) {
    //                q_block.find(".AnswerBlock").find(".AnswerItem").each(function () {
    //                    $(this).find('div:first').find('input').attr("type", "radio");
    //                })
    //                if (type_question == 2) {
    //                    if (q_block.find('.BlockingListDiv').find('.BlockItem').length > 0) {
    //                        $.post("/Question/deleteAllBlocks", { id_question: id_question })
    //                    }
    //                }
    //                if (type_question == 3) {
    //                    if (q_block.find('.PanelOfRange').find('.RangeItem').length > 0) {
    //                        $.post("/Question/DeletaAllRangeQ", { id_question: id_question });
    //                    }
    //                }
    //            }
    //            if (type_question == 4) {
    //                $.post("/Question/DeleteAllTableRow", { id_q: id_question })
    //                var list_answer = [];
    //                q_block.find(".TableStyle").find(".AnswerTableLine").find(".TextAnswerDiv").each(function () {
    //                    list_answer.push(Number($(this).attr("id")));
    //                })
    //                if (list_answer.length > 0) $.post("/Question/DeleteListAnswer", { list: list_answer });
    //                q_block.find(".TableStyle").parent().parent().remove();
    //            }
    //            if (type_question == 6) {
    //                var str_path = q_block.find(".AnswerBlock").find(".AnswerSettings").find("p[name=path_file]").text();
    //                $.post("/Group/DeleteFile", { path: str_path });
    //            }
    //            q_block.find('.PanelSettings').empty();
    //            q_block.find('div[name=QuestionInfo]').find('input[name=questionType]').val("1");
    //            LoadSettingsSingle(q_block.find('.AnswerSettings'));
    //        }
    //            break;
    //        case 'Multi': {
    //            var type_question = Number(q_block.find('div[name=QuestionInfo]').find('input[name=questionType]').val());
    //            if (type_question == 1 || type_question == 3) {
    //                q_block.find(".AnswerBlock").find(".AnswerItem").each(function () {
    //                    $(this).find('div:first').find('input').attr("type", "checkbox");
    //                })
    //                if (type_question == 1) {
    //                    if (q_block.find('.TransitionListDiv').find('.TransItem').length > 0) {
    //                        $.post("/Question/deleteAllTransition", { id_question: id_question })
    //                    }
    //                }
    //                if (type_question == 3) {
    //                    if (q_block.find('.PanelOfRange').find('.RangeItem').length > 0) {
    //                        console.log("ID Question ---- ", id_question);
    //                        $.post("/Question/DeletaAllRangeQ", { id_question: id_question });
    //                    }
    //                }
    //            }
    //            if (type_question == 4) {
    //                $.post("/Question/DeleteAllTableRow", { id_q: id_question })
    //                var list_answer = [];
    //                q_block.find(".TableStyle").find(".AnswerTableLine").find(".TextAnswerDiv").each(function () {
    //                    list_answer.push(Number($(this).attr("id")));
    //                })
    //                if (list_answer.length > 0) $.post("/Question/DeleteListAnswer", { list: list_answer });
    //                q_block.find(".TableStyle").parent().parent().remove();
    //            }
    //            if (type_question == 6) {
    //                var str_path = q_block.find(".AnswerBlock").find(".AnswerSettings").find("p[name=path_file]").text();
    //                $.post("/Group/DeleteFile", { path: str_path });
    //            }
    //            q_block.find('.PanelSettings').empty();
    //            q_block.find('div[name=QuestionInfo]').find('input[name=questionType]').val("2");
    //            var query = {
    //                Id: id_question,
    //                IsKvot: false,
    //                IsRotate: false,
    //                LimitCount: null
    //            }
    //            LoadSettingsMilti(q_block.find('.AnswerSettings'), query);
    //        }
    //            break;
    //        case 'Free': {
    //            var type_question = Number(q_block.find('div[name=QuestionInfo]').find('input[name=questionType]').val());
    //            if (type_question == 1 || type_question == 2) {
    //                q_block.find(".AnswerBlock").find(".AnswerItem").each(function () {
    //                    $(this).find('div:first').find('input').attr("type", "text").attr("placeholder", "Текстовый блок");
    //                })
    //                if (q_block.find('.TransitionListDiv').find('.TransItem').length > 0) {
    //                    $.post("/Question/deleteAllTransition", { id_question: id_question });
    //                }
    //                if (q_block.find('.BlockingListDiv').find('.BlockItem').length > 0) {
    //                    $.post("/Question/deleteAllBlocks", { id_question: id_question });
    //                }
    //            }
    //            if (type_question == 4) {
    //                $.post("/Question/DeleteAllTableRow", { id_q: id_question })
    //                var list_answer = [];
    //                q_block.find(".TableStyle").find(".AnswerTableLine").find(".TextAnswerDiv").each(function () {
    //                    list_answer.push(Number($(this).attr("id")));
    //                })
    //                if (list_answer.length > 0) $.post("/Question/DeleteListAnswer", { list: list_answer });
    //                q_block.find(".TableStyle").parent().parent().remove();
    //            }
    //            if (type_question == 6) {
    //                var str_path = q_block.find(".AnswerBlock").find(".AnswerSettings").find("p[name=path_file]").text();
    //                $.post("/Group/DeleteFile", { path: str_path });
    //            }
    //            q_block.find('.PanelSettings').empty();
    //            q_block.find('div[name=QuestionInfo]').find('input[name=questionType]').val("3");
    //            LoadSettingsFree(q_block.find('.AnswerSettings'));
    //        }
    //            break;
    //        case 'Table': {
    //            var type_question = Number(q_block.find('div[name=QuestionInfo]').find('input[name=questionType]').val());
    //            if (type_question == 3 || type_question == 2) {
    //                q_block.find(".AnswerBlock").find(".AnswerItem").each(function () {
    //                    $(this).find('div:first').find('input').attr("type", "radio");
    //                })
    //                if (type_question == 2) {
    //                    if (q_block.find('.BlockingListDiv').find('.BlockItem').length > 0) {
    //                        $.post("/Question/deleteAllBlocks", { id_question: id_question })
    //                    }
    //                }
    //                if (type_question == 3) {
    //                    if (q_block.find('.PanelOfRange').find('.RangeItem').length > 0) {
    //                        console.log("ID Question ---- ", id_question);
    //                        $.post("/Question/DeletaAllRangeQ", { id_question: id_question });
    //                    }
    //                }
    //            }
    //            if (type_question == 6) {
    //                var str_path = q_block.find(".AnswerBlock").find(".AnswerSettings").find("p[name=path_file]").text();
    //                $.post("/Group/DeleteFile", { path: str_path });
    //            }
    //            q_block.find('.AnswerSettings').empty();
    //            q_block.find('.PanelSettings').empty();
    //            q_block.find('div[name=QuestionInfo]').find('input[name=questionType]').val("4");
    //            LoadSettingsTable(q_block.find('.AnswerSettings'));
    //        }
    //            break;
    //        case 'Text': {
    //            var type_question = Number(q_block.find('div[name=QuestionInfo]').find('input[name=questionType]').val());
    //            if (type_question == 6) {
    //                var str_path = q_block.find(".AnswerBlock").find(".AnswerSettings").find("p[name=path_file]").text();
    //                $.post("/Group/DeleteFile", { path: str_path });
    //            }
    //            q_block.find('.AnswerSettings').empty();
    //            q_block.find('.PanelSettings').empty();
    //            q_block.find('.AnswerBlock').find('.AnswerItem').each(function () {
    //                $(this).remove();
    //            })
    //            q_block.find('div[name=QuestionInfo]').find('input[name=questionType]').val("5");
    //        }
    //            break;
    //        case 'Filter': {
    //            var type_question = Number(q_block.find('div[name=QuestionInfo]').find('input[name=questionType]').val());
    //            if (type_question == 3 || type_question == 2 || type_question == 1) {
    //                if (type_question == 2) {
    //                    if (q_block.find('.BlockingListDiv').find('.BlockItem').length > 0) {
    //                        $.post("/Question/deleteAllBlocks", { id_question: id_question })
    //                    }
    //                }
    //                if (type_question == 1) {
    //                    if (q_block.find('.TransitionListDiv').find('.TransItem').length > 0) {
    //                        $.post("/Question/deleteAllTransition", { id_question: id_question })
    //                    }
    //                    if (q_block.find('.BlockingListDiv').find('.BlockItem').length > 0) {
    //                        $.post("/Question/deleteAllBlocks", { id_question: id_question })
    //                    }
    //                }
    //                if (type_question == 3) {
    //                    if (q_block.find('.PanelOfRange').find('.RangeItem').length > 0) {
    //                        console.log("ID Question ---- ", id_question);
    //                        $.post("/Question/DeletaAllRangeQ", { id_question: id_question });
    //                    }
    //                }
    //            }
    //            if (type_question == 4) {
    //                $.post("/Question/DeleteAllTableRow", { id_q: id_question })
    //                var list_answer = [];
    //                q_block.find(".TableStyle").find(".AnswerTableLine").find(".TextAnswerDiv").each(function () {
    //                    list_answer.push(Number($(this).attr("id")));
    //                })
    //                if (list_answer.length > 0) $.post("/Question/DeleteListAnswer", { list: list_answer });
    //                q_block.find(".TableStyle").parent().parent().remove();
    //            }
    //            q_block.find('.AnswerSettings').empty();
    //            q_block.find('.PanelSettings').empty();
    //            q_block.find('div[name=QuestionInfo]').find('input[name=questionType]').val("6");
    //            LoadSettingsFilter(q_block.find('.AnswerSettings'));
    //        }
    //            break;
    //        default:
    //            alert("Other")
    //            break;
    //    }
    //}


        /*
         *  Загрузка инструментов настройки для Single вопросов
         */
        //function LoadSettingsSingle(panel, q_data) {
        //    panel.empty();
        //    panel.append("<div class='AddAnswerSingle StyleButton' style='height: 100%;'>&#10010; Ответ</div>");
        //    panel.append("<div class='AddBaseAnswer StyleButton' style='width: 120px; background-color: #81c784; height: 100%;'>&#10010; Базовый ответ</div>")
        //    panel.append("<div class='ButtonSlideSettings StyleButton' style='height: 100%'>Настройки</div>");
        //    var block = panel.parent().find('.PanelSettings');
        //    block.append('<div class="QuotaDiv" style="width: 100%; display: inline-flex; background-color: #008dd2; padding: 5px;"><div class="TextSettingPanel">Квотирование</div><div class="QYes">Да</div><div class="QNo QOn">Нет</div></div>' +
        //        '<div class="RotateDiv" style="width: 100%; display: inline-flex; background-color: #008dd2; padding: 5px;"><div class="TextSettingPanel">Ротирование</div><div class="QYes">Да</div><div class="QNo QOn">Нет</div></div>' +
        //        '<div class="TransitionDiv" style="width: 100%; display: block; background-color: #008dd2; padding: 5px; border: 5px inset #b0bec5;">' +
        //        '<div style="width: 100%"><div class="StyleButton AddTransition" style="background-color: #81c874;">&#10010; Переход</div>' +
        //        '<div class="StyleButton DeleteAllTrans" style="background-color: #f44336;">Удалить все</div>' +
        //        '</div>' +
        //        '<div class="TransitionListDiv" style="width: 100%; display: block; background-color: #008dd2; padding: 5px; border: 1px solid black;"></div>' +
        //        '</div > ' +
        //        '<div class="BlockingDiv" style="width: 100%; display: block; background-color: #008dd2; padding: 5px; border: 5px inset #b0bec5;">' +
        //        '<div class="StyleButton AddBlocking" style="background-color: #81c874;">&#10010; Блок</div>' +
        //        '<div class="StyleButton ClearBlocking" style="background-color: #f44336;">Удалить все</div>' +
        //        '<div class="BlockingListDiv"></div>' +
        //        '</div>'

        //    );
        //    if (q_data != undefined) {
        //        if (q_data.IsKvot) {
        //            block.find('.QuotaDiv').find('.QOn').removeClass('QOn');
        //            block.find('.QuotaDiv').find('.QYes').addClass('QOn');
        //        }
        //        if (q_data.IsRotate) {
        //            block.find('.RotateDiv').find('.QOn').removeClass('QOn');
        //            block.find('.RotateDiv').find('.QYes').addClass('QOn');
        //        }
        //        $.get("/Question/getListTransitionQuestion", { id_q: q_data.Id })
        //            .success(function (tr_data) {
        //                if (tr_data.length > 0) {
        //                    $.each(tr_data, function (i, item) {
        //                        block.find(".TransitionListDiv").append('<div class="TransItem" id="' + item.Id + '" style="display: inline-flex; width: 100%;">' +
        //                            '<div style="display: inline-flex; width: 30%;"><div class="fromQuestion" style="margin-right: 20px;">Преход от </div><div>' + item.fromQuestion + '</div></div>' +
        //                            '<div style="display: inline-flex; width: 30%;"><div class="toQuestion" style="margin-right: 20px;">Переход к </div><div>' + item.toQuestion + '</div></div>' +
        //                            '<div style="display: inline-flex; width: 30%;"><div class="TriggerAnswer" style="margin-right: 20px;">По вопросу </div><div>' + item.TriggerAnswer + '</div></div>' +
        //                            '<div class="StyleButton DeleteTrans" style="width: 30px; height: 30px; background-color: #f44336;">&#10006;</div>' +
        //                            '</div>')
        //                    })
        //                }
        //                console.log("Transition >>> ", tr_data);
        //            })
        //        $.get("/Question/getListBlocksQuestion", { id_q: q_data.Id })
        //            .success(function (bl_data) {
        //                if (bl_data.length > 0) {
        //                    $.each(bl_data, function (i, item) {
        //                        block.find(".BlockingListDiv").append('<div class="BlockItem" id="' + item.Id + '">' +
        //                            '<div style="display: inline-flex; width: 30%;"><div class="toQuestion" style="margin-right: 20px;">Блокировка по вопросу </div><div>' + item.toQuestion + '</div></div>' +
        //                            '<div style="display: inline-flex; width: 60%;"><div class="TypeBlocking" style="margin-right: 20px;">Тип блокировки </div><div>' +
        //                            (item.typeBlock == 1 ? "Блокировка выбранных ответов" : "Блокировка не выбраннх ответов") + '</div></div>' +
        //                            '<div class="StyleButton DeleteBlock" style="width: 30px; height: 30px; background-color: #f44336;">&#10006;</div>' +
        //                            '</div>'
        //                        )
        //                    })
        //                }
        //            })
        //    }
        //}

        //Загрузка инструментов настройки для Multi вопросов
        //function LoadSettingsMilti(panel, q_data) {
        //    panel.empty();
        //    panel.append("<div class='AddAnswerMulti StyleButton' style='height: 100%;'>&#10010; Ответ</div>");
        //    panel.append("<div class='AddBaseAnswer StyleButton' style='width: 120px; background-color: #81c784; height: 100%;'>&#10010; Базовый ответ</div>");
        //    panel.append("<div class='ButtonSlideSettings StyleButton' style='height: 100%;'>Настройки</div>");
        //    var block = panel.parent().find('.PanelSettings');
        //    var len_trans_item = block.find('.TransitionListDiv').find('.TransItem').length;
        //    var len_block_item = block.find('.BlockingListDiv').find('.BlockItem').length;
        //    console.log("Length --- ", len_trans_item);
        //    block.append(
        //        '<div class="RotateDiv" style="width: 100%; display: inline-flex; background-color: #008dd2; padding: 5px;"><div class="TextSettingPanel">Ротирование</div><div class="QYes">Да</div><div class="QNo QOn">Нет</div></div>' +
        //        '<div class="LimitCountAnswer" style="width: 100%; display: inline-flex; background-color: #008dd2; padding: 5px;"><div class="TextSettingPanel">Ограничение выбора ответов</div><div class="CountLimit"><input type="text" style="width: 50px;"/></div></div>'+
        //        '<div class="BlockingDiv" style="width: 100%; display: block; background-color: #008dd2; padding: 5px; border: 5px inset #b0bec5;">' +
        //        '<div class="StyleButton AddBlocking" style="background-color: #81c874;">&#10010; Блок</div>' +
        //        '<div class="StyleButton ClearBlocking" style="background-color: #f44336;">Удалить все</div>' +
        //        '<div class="BlockingListDiv"></div>' +
        //        '</div>'
        //    );
        //    if (q_data != undefined) {
        //        if (q_data.IsRotate) {
        //            block.find('.RotateDiv').find('.QOn').removeClass('QOn');
        //            block.find('.RotateDiv').find('.QYes').addClass('QOn');
        //        }
        //        block.find('.LimitCountAnswer').find('.CountLimit').find('input').val(q_data.LimitCount);
        //        $.get("/Question/getListBlocksQuestion", { id_q: q_data.Id })
        //            .success(function (bl_data) {
        //                if (bl_data.length > 0) {
        //                    $.each(bl_data, function (i, item) {
        //                        block.find(".BlockingListDiv").append('<div class="BlockItem" id="' + item.Id + '">' +
        //                            '<div style="display: inline-flex; width: 30%;"><div class="toQuestion" style="margin-right: 20px;">Блокировка по вопросу </div><div>' + item.toQuestion + '</div></div>' +
        //                            '<div style="display: inline-flex; width: 60%;"><div class="TypeBlocking" style="margin-right: 20px;">Тип блокировки </div><div>' +
        //                            (item.typeBlock == 1 ? "Блокировка выбранных ответов" : "Блокировка не выбраннх ответов") + '</div></div>' +
        //                            '<div class="StyleButton DeleteBlock" style="width: 30px; height: 30px; background-color: #f44336;">&#10006;</div>' +
        //                            '</div>'
        //                        )
        //                    })
        //                }
        //            })
        //    }
        //}

        //Загрузка инструментов настройки для Free вопросов
        //function LoadSettingsFree(panel, q_data) {
        //    panel.empty();
        //    panel.append("<div class='AddAnswerFree StyleButton' style='height: 100%;'>&#10010; Ответ</div>");
        //    panel.append("<div class='ButtonSlideSettings StyleButton' style='height: 100%;'>Настройки</div>");
        //    var block = panel.parent().find('.PanelSettings');
        //    block.append(
        //        '<div class="QuotaDiv" style="width: 100%; display: none; background-color: #008dd2; padding: 5px;"><div class="TextSettingPanel">Квотирование</div><div class="QYes">Да</div><div class="QNo QOn">Нет</div></div>' +
        //        '<div class="MasskDiv" style="width: 100%; display: inline-flex; background-color: #008dd2; padding: 5px;"><div class="TextSettingPanel">Тип масски текста</div><div class="TypeMassk"><select class="CheckTypeMassk" required>' +
        //        '<option value="" hidden>Выберите маску</option>' +
        //        '<option value="1">Возраст</option>' +
        //        '<option value="2">Число</option>' +
        //        '</select></div></div>' +
        //        '<div class="RangeDiv" style="width: 100%; display: none;">' +
        //        '<div class="SettingsRange" style="width: 100%; display: inline-flex; background-color: #b0bec5;">' +
        //        '<input class="LowerLimit" type="text" style="width: 50px;" />-<input class="UpperLimit" type="text" style="width: 50px;" /><div class="StyleButton AddRange" style="background-color: #81c784;">Добавить</div>' +
        //        '<div class="StyleButton DeleteListRange" style="background-color: #f44336;">Удалить все</div>' +
        //        '<div class="StyleButton SaveRangeList" style="background-color: #81c784;">Сохранить</div>' +
        //        '</div>' +
        //        '<div class="PanelOfRange" style="display: flex; flex-direction: column; align-items: flex-start; border: 5px inset #b0bec5;"></div>' +
        //        '</div>'
        //    );
        //    if (q_data != undefined) {
        //        if (q_data.IsRotate) {
        //            block.find('.QuotaDiv').find('.QOn').removeClass('QOn');
        //            block.find('.QuotaDiv').find('.QYes').addClass('QOn');
        //        }
        //        if (q_data.TypeMassk == 1) {
        //            block.find('.QuotaDiv').css("display", "inline-flex");
        //            if (q_data.IsKvot) {
        //                block.find('.QuotaDiv').find('.QOn').removeClass('QOn');
        //                block.find('.QuotaDiv').find('.QYes').addClass('QOn');
        //                block.find('.Q')
        //            }
        //            block.find('.RangeDiv').slideDown(200);
        //        }
        //        var type_massk = q_data.TypeMassk;
        //        block.find(".MasskDiv").find(".CheckTypeMassk").find("option[value='" + type_massk + "']").attr("selected", "selected");
        //        var project_id = q_data.ProjectID;
        //        var question_id = q_data.Id;
        //        console.log(project_id + " - " + question_id);
        //        $.get("/Question/GetRange", { id_p: project_id, bind_q: question_id })
        //            .success(function (r_data) {
        //                if (r_data != null && r_data != undefined) {
        //                    var code = "";
        //                    $.each(r_data, function (i, item) {
        //                        code += '<div class="RangeItem" style="display: inline-flex; justify-content: center; align-items: center; flex-direction: row; align-content: space-between;"><div class="IndexRange" id="' +
        //                            item.IndexRange + '">' + item.IndexRange + ')</div><div class="StringRange" style="margin-left: 5px;">' + item.RangeString +
        //                            '</div>' +
        //                            '<input type="hidden" name="RangeID" value="'+item.Id+'"></div>';
        //                    })
        //                    block.find(".PanelOfRange").append(code);
        //                }
        //            })
        //    }
        //}

        //Загрузка инструментов настройки для Table вопросов
        //function LoadSettingsTable(panel, q_data) {
        //    var answer_block = panel.parents(".AnswerBlock")
        //    console.log("Length --- ", answer_block.find('.TableStyle').length)
        //    if (answer_block.find('.TableStyle').length > 0) {
        //        panel.append("<div class='AddColumnTable StyleButton' style='height: 100%; background-color: #81c784;'>&#10010;столбец</div>");
        //        panel.append("<div class='AddRowTable StyleButton' style='height: 100%; background-color: #81c784;'>&#10010;строку</div>");
        //        panel.append("<div class='ButtonSlideSettings StyleButton' style='height: 100%;'>Настройки</div>");
        //        var block = panel.parent().find('.PanelSettings');
        //        block.append(
        //            '<div class="BindQuestionDiv" style="width: 100%; display: inline-flex; background-color: #008dd2; padding: 5px;">' +
        //            '<div class="TextSettingPanel">Связать с вопросом</div>' +
        //            '<div class="BindYes StyleButton" style="width: 30px;">Да</div><div class="BindNo StyleButton QOn" style="width: 30px;">Нет</div>' +
        //            '</div>' +
        //            '<div class="OwnIndexDiv" style="width: 100%; display: inline-flex; background-color: #008dd2; padding: 5px;"><div class="TextSettingPanel">Задать свои индексы</div>' +
        //            '<div class="QYes">Да</div><div class="QNo QOn">Нет</div></div>' +
        //            '<div class="BlockingDiv" style="width: 100%; display: block; background-color: #008dd2; padding: 5px; border: 5px inset #b0bec5;">' +
        //            '<div class="StyleButton AddBlocking" style="background-color: #81c874;">&#10010; Блок</div>' +
        //            '<div class="StyleButton ClearBlocking" style="background-color: #f44336;">Удалить все</div>' +
        //            '<div class="BlockingListDiv"></div>' +
        //            '</div>'
        //        );
        //        if (q_data != undefined) {
        //            console.log("Question --- ", q_data);
        //            if (q_data.Bind != null) {
        //                var bind_id = Number(q_data.Bind)
        //                block.find(".BindQuestionDiv").find(".QOn").removeClass("QOn");
        //                block.find(".BindQuestionDiv").find(".BindYes").addClass("QOn");
        //                block.find(".OwnIndexDiv").find(".QOn").removeClass("QOn");
        //                block.find(".OwnIndexDiv").find(".QYes").addClass("QOn");
        //                var panel_bind = block.find(".BindQuestionDiv").find(".BindYes");
        //                panel_bind.after("<div class='BlockChain' style='background-color: #f44336; width:0px'></div>");
        //                panel_bind.next().animate({ width: "150px" }, 1000);
        //                var block = panel_bind.next();
        //                var code = "<select style='width: 100%; height: 100%;'>";
        //                panel_bind.parents(".BlockQuestionEditor").find(".QuestionBlock").each(function () {
        //                    if (bind_id == Number($(this).find(".QuestionText").attr("id"))) code += "<option value='" + $(this).find(".QuestionText").attr("id") + "' selected>" + $(this).find(".ShortNameQuestion").find("div:first").text() + "</option>";
        //                    else code += "<option value='" + $(this).find(".QuestionText").attr("id") + "'>" + $(this).find(".ShortNameQuestion").find("div:first").text() + "</option>";
        //                })
        //                code += "</select>";
        //                block.append(code);
        //            } else {
        //                panel.parents(".AnswerBlock").find("div.InputOwnIndex").remove();
        //                ResizeItem(answer_block);
        //            }
        //            $.get("/Question/getListBlocksQuestion", { id_q: q_data.Id })
        //                .success(function (bl_data) {
        //                    if (bl_data.length > 0) {
        //                        $.each(bl_data, function (i, item) {
        //                            block.find(".BlockingListDiv").append('<div class="BlockItem" id="' + item.Id + '">' +
        //                                '<div style="display: inline-flex; width: 30%;"><div class="toQuestion" style="margin-right: 20px;">Блокировка по вопросу </div><div>' + item.toQuestion + '</div></div>' +
        //                                '<div style="display: inline-flex; width: 60%;"><div class="TypeBlocking" style="margin-right: 20px;">Тип блокировки </div><div>' +
        //                                (item.typeBlock == 1 ? "Блокировка выбранных ответов" : "Блокировка не выбраннх ответов") + '</div></div>' +
        //                                '<div class="StyleButton DeleteBlock" style="width: 30px; height: 30px; background-color: #f44336;">&#10006;</div>' +
        //                                '</div>'
        //                            )
        //                        })
        //                    }
        //                })
        //        }
        //    } else {
        //        panel.append("<div style='display: inline-flex;' class='SettingsBuildTable'>" +
        //            "<div style='display: flex; justify-content: center; align-items: center;' class='ColumnBuild'>Столбцов</div><input type='text' style='width: 40px;' />" +
        //            "<div style='display: flex; justify-content: center; align-items: center;' class='RowBuild'>Строк</div><input type='text' style='width: 40px;'>" +
        //            "<div class='StyleButton BuildTable' style='background-color: #81c784;'>Создать</div>" +
        //            "</div>");
        //    }
        //}

        //function LoadSettingsFilter(panel, q_data) {

        //    if (q_data != undefined) {
        //        $.get("/Group/CheckFile", { id_q: q_data.Id })
        //            .success(function (f_data) {
        //                console.log("File --- ", typeof (f_data));
        //                if (f_data != null && f_data != "") {
        //                    panel.append("<div class='PathFile' style='width: 80%; height: 100%; display: inline-flex;'><div style='width: 20%; background-color: #008dd2; display: flex; justify-content: center; align-items: center;'>Путь файла</div>" +
        //                        "<div style='width: 70%; display: flex; justify-content: center; align-items: center;'><p name='path_file' style='white-space: nowrap; overflow: hidden; text-overflow: ellipsis;'>" + f_data + "</p></div></div>");
        //                    panel.append("<div class='StyleButton DeleteFile' style='background-color: #f44336; width: 30px; height: 30px; margin-left: 5px;'>&#10006;</div>")
        //                } else {
        //                    panel.append('<input type = "file" id="filter_file" multiple />');
        //                }
        //            })
        //    } else {
        //        panel.append('<input type = "file" id="filter_file" multiple />');
        //    }
        //}
    


    //$('.BlockQuestionEditor').on("click", ".DeleteFile", function () {
    //    var str_path = $(this).parents(".AnswerSettings").find("p[name=path_file]").text();
    //    var block = $(this).parents(".AnswerSettings");
    //    alert(str_path);
    //    $.post("/Group/DeleteFile", { path: str_path })
    //        .success(function () {
    //            block.empty();
    //            LoadSettingsFilter(block);
    //        })
    //})
    
        // Открытие панели добавления базового вопроса
        //$('.BlockQuestionEditor').on("click", ".AddBaseAnswer", function () {
        //    var panel = $(this);
        //    $.get("/Question/getListAnswerBase")
        //        .success(function (base_data) {
        //            list_base_answer = {};
        //            $.each(base_data, function (i, item) {
        //                list_base_answer[item.Id] = item;
        //            })
        //            var code = "<div style='height: 100%;'><select style='height: 100%;'>";
        //            $.each(base_data, function (i, item) {
        //                code += "<option value='" + item.Id + "'>" + item.AnswerText + "</option>";
        //            })
        //            code += "</select><div class='AddBase StyleButton' style='background-color: #81c784; height: 100%;'>Добавить</div></div>";
        //            panel.after(code);
        //            panel.remove();
        //        })
        //})

        // Добавление базового вопроса
        //$('.BlockQuestionEditor').on("click", ".AddBase", function () {
        //    var type_question = Number($(this).parents(".QuestionBlock").find('div[name=QuestionInfo]').find('input[name=questionType]').val());
        //    var block = $(this).parents(".QuestionBlock");
        //    $(this).parent().after("<div class='AddBaseAnswer StyleButton' style='width: 120px; background-color: #81c784; height: 100%;'>&#10010; Базовый ответ</div>");
        //    var id_base_answer = Number($(this).parent().find("select option:checked").val());
        //    var str_base_answer = $(this).parent().find("select option:checked").text()
        //    var is_exist = false;
        //    block.find(".BaseAnswer").each(function () {
        //        if ($(this).find(".IndexAnswer").next().text() == str_base_answer) {
        //            is_exist = true;
        //            alert("Уже есть");
        //            return false;
        //        }
        //    })
        //    if (is_exist == false) {
        //        switch (type_question) {
        //            case 1: {
        //                block.find(".AnswerBlock").append('<div class="AnswerItem BaseAnswer" id=' + id_base_answer + '><div style="margin-right: 15px"><input type="radio" disabled/></div><div class="IndexAnswer">' + -1 * Number(list_base_answer[id_base_answer].BaseIndex) + ') </div><div style="width: 100%;">' + str_base_answer + '</div><div class="DeleteAnswerItem">&#10006;</div></div>');
        //            }
        //                break;
        //            case 2: {
        //                block.find(".AnswerBlock").append('<div class="AnswerItem BaseAnswer" id=' + id_base_answer + '><div style="margin-right: 15px"><input type="checkbox" disabled/></div><div class="IndexAnswer">' + -1 * Number(list_base_answer[id_base_answer].BaseIndex) + ') </div><div style="width: 100%;">' + str_base_answer + '</div><div class="DeleteAnswerItem">&#10006;</div></div>');
        //            }
        //                break;
        //            default:
        //                break;
        //        }
        //    }
        //    $(this).parent().remove();
        //})
 
        //$('.BlockQuestionEditor').on("click", ".BindYes", function () {
        //    $(this).next().removeClass("QOn");
        //    $(this).addClass("QOn");
        //    if ($(this).parent().find(".BlockChain").length == 0) {
        //        $(this).after("<div class='BlockChain' style='background-color: #f44336; width:0px'></div>");
        //        $(this).next().animate({ width: "150px" }, 1000);
        //        var block = $(this).next();
        //        var code = "<select style='width: 100%; height: 100%;'>";
        //        $(this).parents(".BlockQuestionEditor").find(".QuestionBlock").each(function () {
        //            code += "<option value='" + $(this).find(".QuestionText").attr("id") + "'>" + $(this).find(".ShortNameQuestion").find("div:first").text() + "</option>";
        //        })
        //        code += "</select>";
        //        block.append(code);
        //    }
        //})

        //$('.BlockQuestionEditor').on("click", ".BindNo", function () {
        //    $(this).prev().remove();
        //    $(this).prev().removeClass("QOn");
        //    $(this).addClass("QOn");
        //})


        // Функция создание таблици в новом табличном вопросе
        //$('.BlockQuestionEditor').on("click", ".BuildTable", function () {
        //    var panel = $(this).parents(".SettingsBuildTable");
        //    var count_column = Number(panel.find(".ColumnBuild").next().val());
        //    var count_row = Number(panel.find(".RowBuild").next().val());
        //    console.log("Column " + count_column + " Row " + count_row);
        //    var code = "<div style='position: relative'><div style='overflow-x: scroll; overflow-y: visible; margin-left: 200px;'><table class='TableStyle' style='width: 100%;'>";
        //    for (var row_i = 0; row_i <= count_row; row_i++) {
        //        if (row_i == 0) {
        //            code += "<tr class='AnswerTableLine'>";
        //        } else {
        //            code += "<tr>";
        //        }
        //        for (var col_i = 0; col_i <= count_column; col_i++) {
        //            if (row_i == 0 && col_i == 0) code += "<td></td>";
        //            if (row_i == 0 && col_i > 0) {
        //                code += "<td style='min-width: 200px; max-width: 200px; vertical-align: top;' class='TableColumnText Column" + col_i + "' id=" + col_i + ">" +
        //                    "<div style='display: inline-flex; flex-direction: row; width: 100%;'>" +
        //                    "<div style='display: inline-flex; width: 100%;' class='TextAnswerDiv' id='0'>New Item</div>" +
        //                    "<div class='PanelColumn' style='display: flex; flex-direction: column; vartical-align: top;'>" +
        //                    "<div style='width: 20px; height: 20px; background-color: #f44336;' class='DeleteColumn StyleButton'>&#10006;</div>" +
        //                    "<div style='width: 20px; height: 20px; background-color: #f44336;' class='StyleButton EditTextColumn'>&#9000;</div>" +
        //                    "</div></div></td>";
        //            }
        //            if (row_i > 0 & col_i == 0) {
        //                code += "<td style='min-width: 200px; max-width: 200px; position: absolute; left: 0;' class='TableRowText'>" +
        //                    "<div style='display: inline-flex; flex-direction: row; width: 100%'>" +
        //                    "<div style='display: inline-flex; width: 100%' class='TextTableRowDiv' id='0'>New question</div>" +
        //                    "<div class='PanelRow' style='display: flex; flex-direction: column'>" +
        //                    "<div style='width: 20px; height: 20px; background-color: #f44336;' class='StyleButton DeleteRow'>&#10006;</div>" +
        //                    "<div style='width: 20px; height: 20px; background-color: #f44336;' class='StyleButton EditTextRow'>&#9000;</div>" +
        //                    "</div></div>" +
        //                    "</td>";
        //            }
        //            if (row_i > 0 & col_i > 0) code += "<td class='TypeItemTable Column" + col_i + "' id=" + col_i + "><div><input type='radio' disabled></div></td>";
        //        }
        //        code += "</tr>";
        //    }
        //    code += "</table></div></div>";
        //    $(this).parents(".QuestionBlock").find("div.AnswerBlock").append(code);
        //    ResizeItem($(this).parents(".QuestionBlock").find(".AnswerBlock"));
        //   // $(this).parents(".QuestionBlock").find(".AnswerSettings").find(".SettingsBuildTable").remove();
        //   // $(this).parents(".QuestionBlock").find(".AnswerSettings").append('<div class="StyleButton">Button</div>');
        //    LoadSettingsTable($(this).parents(".QuestionBlock").find(".AnswerSettings"));
        //    $(this).parents(".QuestionBlock").find(".AnswerSettings").find(".SettingsBuildTable").remove();
        //})

        //Удаление одной позиции диапозона возрастов
        //$('.BlockQuestionEditor').on("click", ".RemoveRangePos", function () {
        //    var item_block = $(this).parents(".RangeItem");
        //    var index_range = Number(item_block.find(".IndexRange").attr("id"));
        //    item_block.nextAll().each(function () {
        //        $(this).find(".IndexRange").attr("id", index_range).text(index_range + ")");
        //        index_range++;
        //    })
        //    item_block.remove();
        //    var block = $(this).parents(".PanelOfRange");

        //})

        //Удаление всего списка диапазона возрастов
        //$('.BlockQuestionEditor').on("click", ".DeleteListRange", function () {
        //    var block = $(this).parents(".QuestionBlock");
        //    var id_question = Number(block.find("div[name=QuestionInfo]").find("input[name=questionInfo]").val());
        //    block.find(".PanelOfRange").find(".RangeItem").each(function () {
        //        var id_range;
        //        if ($(this).find("input[name=RangeID]").length > 0) {
        //            var remove_block = $(this);
        //            id_range = Number($(this).find("input[name=RangeID]").val());
        //            console.log("Id range --- ", id_range);
        //            $.post("/Question/DeleteRangePos", { id_range: id_range, id_q: id_question })
        //                .success(function () { remove_block.remove() })
        //        } else {
        //            $(this).remove();
        //        }
        //    })
        //})

        //Функция сохранения диапозона возрастов
        // $('.BlockQuestionEditor').on("click", ".SaveRangeList", function () {
        //    var block = $(this).parents(".QuestionBlock");
        //    var project_id = Number($('div[name=ProjectInfo]').find("input[name=project_id]").val());
        //    var question_id = Number(block.find("div[name=QuestionInfo]").find("input[name=questionInfo]").val());
        //    var list_range = [];
        //    block.find(".RangeDiv").find(".RangeItem").each(function () {
        //        list_range.push($(this).find("div.StringRange").text() + "#" + $(this).find(".IndexRange").attr('id'));
        //    })
        //    var query = {
        //        id_p: project_id,
        //        bind_q: question_id,
        //        list_range: list_range
        //    }
        //    $.post("/Question/SaveRange", query)
        //        .success(function () {
        //            alert("Диапозоны сохранены");
        //        })
        //    //console.log("Query range --- ", query);
        //})

        //Функция изменения типа маски для Free вопроса
        //$('.BlockQuestionEditor').on("change", ".CheckTypeMassk", function() {
        //    var container = $(this).parents(".PanelSettings");
        //    var type_massk = Number($(this).find("option:checked").val());
        //    if (type_massk == 1) {
        //        container.find(".QuotaDiv").css("display", "inline-flex");
        //        container.find(".RangeDiv").slideDown(200);
        //    } else {
        //        container.find(".RangeDiv").slideUp(200);
        //        container.find(".QuotaDiv").slideUp(200);
        //    }
        //})

        //Добавление позиции диапозона возроста
        //$('.BlockQuestionEditor').on("click", ".AddRange", function () {
        //    var container_range = $(this).parents(".RangeDiv");
        //    var LowerContainer = container_range.find('input.LowerLimit');
        //    var UpperContainer = container_range.find('input.UpperLimit');
        //    var lower_limit = LowerContainer.val() != "" ? Number(LowerContainer.val()) : -Infinity;
        //    var upper_limit = UpperContainer.val() != "" ? Number(UpperContainer.val()) : Infinity;
        //    if (upper_limit <= lower_limit) {
        //        alert("Нижний предел не может быть больше верхнего");
        //        return;
        //    }
        //    var is_out = false
        //    console.log(lower_limit + "-" + upper_limit);
        //    container_range.find('.PanelOfRange').find('.StringRange').each(function () {
        //        var e_lower_limit = !isNaN(Number($(this).text().split('-')[0])) ? Number($(this).text().split('-')[0]) : -Infinity;
        //        var e_upper_limit = !isNaN(Number($(this).text().split('-')[1])) ? Number($(this).text().split('-')[1]) : Infinity;
        //        if (((e_lower_limit <= lower_limit) && (lower_limit <= e_upper_limit)) || ((e_lower_limit <= upper_limit) && (upper_limit <= e_upper_limit))) {
        //            alert("Диапозоны пересекаются");
        //            is_out = true;
        //            return false;
        //        }
        //    })
        //    if (is_out) { return; }
        //    var index_range = 1;
        //    if (container_range.find('.PanelOfRange').find('.IndexRange').length >= 1) {
        //        index_range = Number($('.PanelOfRange').find(".IndexRange:last").attr('id')) + 1;
        //    }
        //    var code = '<div class="RangeItem" style="display: inline-flex; justify-content: center; align-items: center; flex-direction: row; align-content: space-between;"><div class="IndexRange" id="' + index_range + '">' + index_range + ')</div><div class="StringRange" style="margin-left: 5px;">' + (lower_limit != -Infinity ? lower_limit : ("меньше " + upper_limit)) + ' - ' + (upper_limit != Infinity ? upper_limit : "больше " + lower_limit) + '</div><div style="background-color: #f44336; width: 15px; height: 15px; margin-left: 10px;" class="RemoveRangePos StyleButton">&#10006;</div></div>';
        //    container_range.find('.PanelOfRange').append(code);
        //    LowerContainer.val(upper_limit + 1);
        //    UpperContainer.val("");
        //            });
    }

    let keys = { 37: 1, 38: 1, 39: 1, 40: 1 };

    function preventDefault(e) {
        e = e || window.event;
        if (e.preventDefault)
            e.preventDefault();
        e.returnValue = false;
    }

    function preventDefaultForScrollKeys(e) {
        if (keys[e.keyCode]) {
            preventDefault(e);
            return false;
        }
    }

    function disableScroll() {
        if (window.addEventListener) // older FF
            window.addEventListener('DOMMouseScroll', preventDefault, false);
        window.onwheel = preventDefault; // modern standard
        window.onmousewheel = document.onmousewheel = preventDefault; // older browsers, IE
        window.ontouchmove = preventDefault; // mobile
        document.onkeydown = preventDefaultForScrollKeys;
    }

    function enableScroll() {
        if (window.removeEventListener)
            window.removeEventListener('DOMMouseScroll', preventDefault, false);
        window.onmousewheel = document.onmousewheel = null;
        window.onwheel = null;
        window.ontouchmove = null;
        document.onkeydown = null;
    }

    {
    //Добавление блокировки к вопросу
    //$('.BlockQuestionEditor').on("click", ".AddBlocking", function () {
    //    var project_id = Number($('div[name=ProjectInfo]').find('input[name=project_id]').val());
    //    var question_id = Number($(this).parents('.QuestionBlock').find('div[name=QuestionInfo]').find('input[name=questionInfo]').val());
    //    console.log("Project Info ---- ", project_id);
    //    console.log("Question Info ---- ", question_id);
    //    var code = '<div class="BlockWallTrans">' +
    //        '<div class="BlockingSettingsPanel">' +
    //        '<input type="hidden" name="Project_id" value="' + project_id + '" />' +
    //        '<input type="hidden" name="Question_id" value="' + question_id + '" />' +
    //        '<div style="display: inline-flex; width: 100%; height: 30px; font-family: Century Gothic;"><div class="ToQuestion" style="width: 50%;">Перейти к </div></div>' +
    //        '<div style="display: inline-flex; width: 100%; height: 30px; font-family: Century Gothic;"><div class="TypeBlocking" style="width: 50%;">Тип блокировки </div></div>' +
    //        '<div class="StyleButton SaveBlocking" style="background-color: #81c784;">Сохранить</div>' +
    //        '</div>' +
    //        '<div class="CloseBlockWallTrans">&#10006;</div>'
    //    '</div>';
    //    $('body').append(code);
    //    $.get("/Group/getGroup", { id_p: project_id })
    //        .success(function (g_data) {
    //            var q_code = '<div style="width: 30%;"><select style="width: 100%;">'
    //            $.each(g_data, function (i, item) {
    //                q_code += '<option value="' + item.QuestionID + '">' + item.GroupName + '</option>';
    //            })
    //            q_code += '</select></div>';
    //            $('.ToQuestion').after(q_code);
    //        })
    //    var count_save_answer = 0;
    //    var an_code = '<div style="width: 49%;"><select style="width: 100%;">';
    //    an_code += '<option value="1">Блокировка выбранных ответов</option>';
    //    an_code += '<option value="2">Блокировка не выбранных ответов</option>';
    //    an_code += '</select></div>';
    //    $('.BlockingSettingsPanel').find('.TypeBlocking').after(an_code);
    //    disableScroll();
    //})

    //Удаление всех переходов в вопросе
    //$('.BlockQuestionEditor').on("click", ".DeleteAllTrans", function () {
    //    var id_q = Number($(this).parents(".QuestionBlock").find(".QuestionText").attr("id"));
    //    var block = $(this).parents(".QuestionBlock");
    //    $.post("/Question/deleteAllTransition", { id_question: id_q })
    //        .success(function () {
    //            block.find('.TransitionListDiv').find(".TransItem").each(function () {
    //                $(this).remove();
    //            })
    //        })
    //})

    //Удаление перехода в вопросе
    //$('.BlockQuestionEditor').on("click", ".DeleteTrans", function () {
    //    var block = $(this).parent();
    //    var id_trans = Number(block.attr('id'));
    //    $.post("/Question/deleteTransition", { id_transition: id_trans })
    //        .success(function () {
    //            block.remove();
    //        })
    //})

    //Удаление блокировки с вопроса
    //$('.BlockQuestionEditor').on("click", ".DeleteBlock", function() {
    //    var block = $(this).parents(".BlockItem");
    //    var id_block = block.attr("id");
    //    $.post("/Question/deleteBlocks", { id_block: id_block })
    //        .success(function () {
    //            block.remove();
    //        })
    //})

    //Удаление всего листа блокировок
    //$('.BlockQuestionEditor').on("click", ".ClearBlocking", function () {
    //    var id_q = Number($(this).parents(".QuestionBlock").find(".QuestionText").attr("id"));
    //    var block = $(this).parents(".QuestionBlock");
    //    $.post("/Question/deleteAllBlocks", { id_question: id_q })
    //        .success(function () {
    //            block.find('.BlockingListDiv').find(".BlockItem").each(function () {
    //                $(this).remove();
    //            })
    //        })
    //})

    //Добавление перехода в вопрос
    //$('.BlockQuestionEditor').on("click", ".AddTransition", function () {
    //    var project_id = Number($('div[name=ProjectInfo]').find('input[name=project_id]').val());
    //    var question_id = Number($(this).parents('.QuestionBlock').find('div[name=QuestionInfo]').find('input[name=questionInfo]').val());
    //    console.log("Project Info ---- ", project_id);
    //    console.log("Question Info ---- ", question_id);
    //    var code = '<div class="BlockWallTrans">' +
    //        '<div class="TransitionSettingsPanel">' +
    //        '<input type="hidden" name="Project_id" value="' + project_id + '" />' +
    //        '<input type="hidden" name="Question_id" value="' + question_id + '" />' +
    //        '<div style="display: inline-flex; width: 100%; height: 30px; font-family: Century Gothic;"><div class="ToQuestion" style="width: 50%;">Перейти к </div></div>' +
    //        '<div style="display: inline-flex; width: 100%; height: 30px; font-family: Century Gothic;"><div class="TriggerAnswer" style="width: 50%;">По вопросу </div></div>' +
    //        '<div class="StyleButton SaveTransition" style="background-color: #81c784;">Сохранить</div>'+
    //        '</div>' +
    //        '<div class="CloseBlockWallTrans">&#10006;</div>'
    //        '</div>';
    //    $('body').append(code);
    //    $.get("/Group/getGroup", { id_p: project_id })
    //        .success(function (g_data) {
    //            var q_code = '<div style="width: 30%;"><select style="width: 100%;">'
    //            $.each(g_data, function (i, item) {
    //                q_code += '<option value="' + item.QuestionID + '">' + item.GroupName + '</option>';
    //            })
    //            q_code += '</select></div>';
    //            $('.ToQuestion').after(q_code);
    //        })
    //    var count_save_answer = 0;
    //    var an_code = '<div style="width: 30%;"><select style="width: 100%;">'
    //    $(this).parents(".QuestionBlock").find(".AnswerBlock").find(".AnswerItem").each(function () {
    //        if (Number($(this).attr('id')) > 0) {
    //            count_save_answer++;
    //            an_code += '<option value="' + $(this).attr('id') + '">' + $(this).find(".TextAnswer").text() + '</option>';
    //        }
    //    })
    //    an_code += '</select></div>';
    //    $('.TransitionSettingsPanel').find('.TriggerAnswer').after(an_code);
    //    disableScroll();
    //})

    //$('body').on("click", ".CloseBlockWallTrans", function () {
    //    $(this).parent().remove();
    //    enableScroll();
    //})

    //$('body').on("mouseenter", ".CloseBlockWallTrans", function () {
    //    $(this).addClass('Scaled');
    //})

    //$('body').on("mouseleave", ".CloseBlockWallTrans", function () {
    //    $(this).removeClass('Scaled');
    //})

    //Сохранение перехода в вопросе
    //$('body').on("click", ".SaveTransition", function () {
    //    var block = $(this).parents(".TransitionSettingsPanel");
    //    var pro_id = Number(block.find('input[name=Project_id]').val());
    //    var fromQ = Number(block.find('input[name=Question_id]').val());
    //    var toQ = Number(block.find('.ToQuestion').next().find('select').find('option:checked').val());
    //    var trigger = Number(block.find('.TriggerAnswer').next().find('select').find('option:checked').val());
    //    var query = {
    //        ProjectID: pro_id,
    //        fromQuestion: fromQ,
    //        toQuestion: toQ,
    //        TriggerAnswer: trigger
    //    }
    //    var is_save = false;
    //    $('.BlockQuestionEditor').find('div.QuestionText[id=' + fromQ + ']').parents(".QuestionBlock")
    //        .find(".TransitionListDiv")
    //        .find(".TransItem").each(function () {
    //            console.log($(this).find(".TriggerAnswer").next().text() + " " + trigger);
    //            var id_answer = Number($(this).find(".TriggerAnswer").next().text());
    //            if (id_answer == trigger) {
    //                alert("Ответ уже под переходом");
    //                is_save = true;
    //                return false;
    //            }
    //        })
    //    console.log("Query --- ", query);
    //    if (is_save == false) {
    //    $.post("/Question/setTransition", query)
    //        .success(function (id_trans) {
    //            $('.BlockQuestionEditor').find('div.QuestionText[id=' + fromQ + ']').parents(".QuestionBlock")
    //                .find(".TransitionListDiv")
    //                .append('<div class="TransItem" id="' + id_trans + '" style="display: inline-flex; width: 100%;">' +
    //                '<div style="display: inline-flex; width: 30%;"><div class="fromQuestion" style="margin-right: 20px;">Преход от </div><div>' + query.fromQuestion + '</div></div>' +
    //                '<div style="display: inline-flex; width: 30%;"><div class="toQuestion" style="margin-right: 20px;">Переход к </div><div>' + query.toQuestion + '</div></div>' +
    //                '<div style="display: inline-flex; width: 30%;"><div class="TriggerAnswer" style="margin-right: 20px;">По вопросу </div><div>' + query.TriggerAnswer + '</div></div>' +
    //                '<div class="StyleButton DeleteTrans" style="width: 30px; height: 30px; background-color: #f44336;">&#10006;</div>' +
    //                '</div>')
    //            enableScroll();
    //            $('body').off("click", ".SaveTransition");
    //            block.parents(".BlockWallTrans").remove();
    //        })
    //    }
    //})
    

    //Сохранение блокировки в вопросе
    //$('body').on("click", ".SaveBlocking", function () {
    //    var block = $(this).parents(".BlockingSettingsPanel");
    //    var pro_id = Number(block.find('input[name=Project_id]').val());
    //    var fromQ = Number(block.find('input[name=Question_id]').val());
    //    var toQ = Number(block.find('.ToQuestion').next().find('select').find('option:checked').val());
    //    var type = Number(block.find('.TypeBlocking').next().find('select').find('option:checked').val());
    //    var query = {
    //        ProjectID: pro_id,
    //        fromQuestion: fromQ,
    //        toQuestion: toQ,
    //        typeBlock: type
    //    }
    //    console.log("Blocking ---- ", query);
    //    var is_save = false;
    //    $('.BlockQuestionEditor').find('div.QuestionText[id=' + fromQ + ']').parents(".QuestionBlock")
    //        .find(".BlockingListDiv")
    //        .find(".BlockItem").each(function () {
    //            var id_answer = Number($(this).find(".toQuestion").next().text());
    //            if (id_answer == toQ) {
    //                alert("Блокировка по вопросу уже установлена");
    //                is_save = true;
    //                return false;
    //            }
    //        })
    //    if (is_save == false) {
    //        $.post("/Question/setBlock", query)
    //            .success(function (id_block) {
    //                $('.BlockQuestionEditor').find('div.QuestionText[id=' + fromQ + ']').parents(".QuestionBlock")
    //                    .find(".BlockingListDiv")
    //                    .append('<div class="BlockItem" id="' + id_block + '" style="display: inline-flex; width: 100%;">' +
    //                        '<div style="display: inline-flex; width: 30%;"><div class="toQuestion" style="margin-right: 20px;">Блокировка по вопросу </div><div>' + query.toQuestion + '</div></div>' +
    //                        '<div style="display: inline-flex; width: 30%;"><div class="TypeBlocking" style="margin-right: 20px;">Тип блокировки </div><div>' + query.typeBlock + '</div></div>' +
    //                        '<div class="StyleButton DeleteBlock" style="width: 30px; height: 30px; background-color: #f44336;">&#10006;</div>' +
    //                        '</div>')
    //                enableScroll();
    //                $('body').off("click", ".SaveBlocking");
    //                block.parents(".BlockWallTrans").remove();
    //            })
    //    }
    //})

    
        //$('body').on("mouseenter", ".SaveTransition", function () {
        //    $(this).addClass('Scaled');
        //})

        //$('body').on("mouseleave", ".SaveTransition", function () {
        //    $(this).removeClass('Scaled');
        //})

        //$('.BlockQuestionEditor').on("mouseenter", ".QNo", function () {
        //    $(this).addClass('Scaled');
        //})

        //$('.BlockQuestionEditor').on("mouseleave", ".QNo", function () {
        //    $(this).removeClass('Scaled');
        //})

        //$('.BlockQuestionEditor').on("click", ".QNo", function () {
        //    var item = $(this).parent();
        //    if (item.hasClass('QuotaDiv')) { // Отключение квотирование в вопросе
        //        if (!$(this).hasClass('QOn')) {
        //            item.find('.QOn').removeClass('QOn');
        //            $(this).addClass('QOn');
        //        }
        //    }
        //    if (item.hasClass('RotateDiv')) { // Отключение ротирование в вопросе
        //        if (!$(this).hasClass('QOn')) {
        //            item.find('.QOn').removeClass('QOn');
        //            $(this).addClass('QOn');
        //        }
        //    }
        //    if (item.hasClass('OwnIndexDiv')) { // Отключение собственных индексов в вопросе
        //        if (!$(this).hasClass('QOn')) {
        //            item.find('.QOn').removeClass('QOn');
        //            $(this).addClass('QOn');
        //            if ($(this).hasClass('QNo')) {
        //                OwnIndexPanelRemove($(this).parents(".QuestionBlock"));
        //            }
        //        }
        //    }
        //})

        //$('.BlockQuestionEditor').on("mouseenter", ".QYes", function () {
        //    $(this).addClass('Scaled');
        //})

        //$('.BlockQuestionEditor').on("mouseleave", ".QYes", function () {
        //    $(this).removeClass('Scaled');
        //})

        // Обработка нажатия кнопки QYes
        //$('.BlockQuestionEditor').on("click", ".QYes", function () {
        //    var item = $(this).parent();
        //    if (item.hasClass('QuotaDiv')) {  // Включение квотирование в вопросе
        //        if (!$(this).hasClass('QOn')) {
        //            item.find('.QOn').removeClass('QOn');
        //            $(this).addClass('QOn');
        //        }
        //    }
        //    if (item.hasClass('RotateDiv')) { // Включение ротирование в вопросе
        //        if (!$(this).hasClass('QOn')) {
        //            item.find('.QOn').removeClass('QOn');
        //            $(this).addClass('QOn');
        //        }
        //    }
        //    if (item.hasClass('OwnIndexDiv')) { // Включение собственные индексы в вопросе
        //        if (!$(this).hasClass('QOn')) {
        //            item.find('.QOn').removeClass('QOn');
        //            $(this).addClass('QOn');
        //            if ($(this).hasClass('QYes')) {
        //                OwnIndexPanelBuild($(this).parents(".QuestionBlock"));
        //            }
        //        }
        //    }
        //})

        // Функция удаления блока собсвенных индексов
        //function OwnIndexPanelRemove(panel) {
        //    var block = panel.find(".AnswerBlock");
        //    block.find(".TableStyle").find(".InputOwnIndex").remove();
        //    ResizeItem(block);
        //}

        // Функция добавления блока собственных индексов
        //function OwnIndexPanelBuild(panel) {
        //    var block = panel.find(".AnswerBlock");
        //    block.find(".TableRowText").each(function () {
        //        $(this).append("<div class='InputOwnIndex' style='display: inline-flex; width: 100%; background-color: #008dd2;'><div>Индекс</div><input type='text' name='OwnIndex' style='width: 100%;' /></div>");
        //    })
        //    $("input[name=OwnIndex]").bind("change keyup input", function () {
        //        if (this.value.match(RegExp("([0-9]{4,5})|(\\D)"))) {
        //            this.value = this.value.substr(0, this.value.length - 1);
        //        }

        //    });
        //    ResizeItem(block);
        //}

    //Функция добавления столбца в таблицу
    //$('.BlockQuestionEditor').on("click", ".AddColumnTable", function () {
    //    $(this).parents(".AnswerBlock").css("overflow_y", "auto");
    //    var table_item = $(this).parents(".AnswerBlock").find(".TableStyle");
    //    var count_row = table_item.find('tr').length;
    //    table_item.find('tr').each(function () {
    //        if ($(this).hasClass('AnswerTableLine')) {
    //            var code = "<td style='min-width: 200px; max-width: 200px; vertical-align: top' class='TableColumnText'>" +
    //                "<div style='display: inline-flex; flex-direction: row; width: 100%;'>" +
    //                "<div style='display: inline-flex; width: 100%;' class='TextAnswerDiv' id='0'>New Item</div>" +
    //                "<div class='PanelColumn' style='display: flex; flex-direction: column; vartical-align: top;'>" +
    //                "<div style='width: 20px; height: 20px; background-color: #f44336;' class='DeleteColumn StyleButton'>&#10006;</div>" +
    //                "<div style='width: 20px; height: 20px; background-color: #f44336;' class='StyleButton EditTextColumn'>&#9000;</div>" +
    //                "</div></div></td>";
    //            $(this).append(code);
    //        } else {
    //            var code = "<td class='TypeItemTable'><div><input type='radio' disabled></div></td>";
    //            $(this).append(code);
    //        }

    //    });

    //})

    //$('.BlockQuestionEditor').on("mouseenter", ".AddColumnTable", function () {
    //    $(this).addClass('Scaled');
    //})

    //$('.BlockQuestionEditor').on("mouseleave", ".AddColumnTable", function () {
    //    $(this).removeClass('Scaled');
    //})

    //Функция добавления строки в таблицу
    //$('.BlockQuestionEditor').on("click", ".AddRowTable", function () {

    //    var count_td = Number($(this).parents(".AnswerBlock").find('.TableStyle').find('tr:first').find('td').length);
    //    var item_table = $(this).parents(".AnswerBlock").find('.TableStyle').find('tbody');
    //    var code = "<tr>"
    //    for (var i_td = 0; i_td < count_td; i_td++) {
    //        if (i_td == 0) {
    //            code += "<td style='min-width: 200px; max-width: 200px;  position: absolute; left: 0;' class='TableRowText'>" +
    //                "<div style='display: inline-flex; flex-direction: row; width: 100%'>" +
    //                "<div style='display: inline-flex; width: 100%' class='TextTableRowDiv' id='0'>New question</div>" +
    //                "<div class='PanelRow' style='display: flex; flex-direction: column'>" +
    //                "<div style='width: 20px; height: 20px; background-color: #f44336;' class='DeleteRow StyleButton'>&#10006;</div>" +
    //                "<div style='width: 20px; height: 20px; background-color: #f44336;' class='EditTextRow StyleButton'>&#9000;</div>" +
    //                "</div></div></td>";
    //        } else {
    //            code += "<td class='TypeItemTable'><div><input type='radio' disabled></div></td>";
    //        }
    //    }
    //    code += "</tr>"
    //    item_table.append(code);
    //    ResizeItem($(this).parents(".AnswerBlock"));
    //})

    //$('.BlockQuestionEditor').on("mouseenter", ".AddRowTable", function () {
    //    $(this).addClass('Scaled');
    //})

    //$('.BlockQuestionEditor').on("mouseleave", ".AddRowTable", function () {
    //    $(this).removeClass('Scaled');
    //})

    
        //$('.BlockQuestionEditor').on("mouseenter", ".ChangeIndex", function () {
        //    $(this).addClass('Scaled');
        //})

        //$('.BlockQuestionEditor').on("mouseleave", ".ChangeIndex", function () {
        //    $(this).removeClass('Scaled');
        //})

        //$('.BlockQuestionEditor').on("click", ".ChangeIndex", function () {
        //    var index_answer = $(this).parent().find('input[name=IndexAnswer]').val()
        //    $(this).empty().after("<div><input class='EditIndexAnswer' style='width: 50px;' type='text' value='" + index_answer + "' /></div>");
        //    $(this).remove();
        //    $(document).mouseup(function (event) {
        //        var container = $('.EditIndexAnswer');
        //        var q_block = $('.EditIndexAnswer').parents(".AnswerItem");
        //        var par_container = $('.EditIndexAnswer').parent();
        //        if (par_container.has(event.target).length === 0) {
        //            var str_index = container.val();
        //            var block = container.parent().parent();
        //            q_block.find(".IndexAnswer").text(str_index + ") ");
        //            block.find('input[name=IndexAnswer]').val(str_index);
        //            par_container.after('<div class="ChangeIndex">ID</div>');
        //            par_container.remove();
        //        }
        //    })
        //})

        //$('.BlockQuestionEditor').on("keyup", ".EditIndexAnswer", function (event) {
        //    if (event.keyCode == 13) {
        //        var str_index = $(this).val()
        //        var block = $(this).parent().parent();
        //        var q_block = $('.EditIndexAnswer').parents(".AnswerItem");
        //        q_block.find(".IndexAnswer").text(str_index + ") ");
        //        block.find('input[name=IndexAnswer]').val(str_index);
        //        $(this).parent().after('<div class="ChangeIndex">ID</div>');
        //        $(this).parent().remove();
        //    }
        //})

        // Добавление ответа в вопрос типа Single
        //$('.BlockQuestionEditor').on("click", ".AddAnswerSingle", function () {
        //    var item_block = $(this).parents(".QuestionBlock");
        //    var index_answer = 0;
        //    if (item_block.find(".AnswerBlock").find(".AnswerItem:not('BaseAnswer')").length != 0) {
        //        index_answer = Number(item_block.find(".AnswerBlock").find(".AnswerItem:not(.BaseAnswer)").last().find('input[name=IndexAnswer]').val());
        //    }
        //    $(this).parents(".QuestionBlock").find(".SaveChangeButton").addClass("NewChangeQuestion");
        //    $(this).parents(".AnswerBlock").append('<div class="AnswerItem NewItem" id=0><div style="margin-right: 15px"><input type="radio" disabled/>' +
        //        '</div><div class="IndexAnswer">' + (index_answer + 1) + ') </div><div style="width: 80%;" class="TextAnswer TextNewItem">New answer</div>' +
        //        '<div class="FreeArea" style="display: inline-flex; width: 20%; height: 100%;"><input type="checkbox" name="FreeAreaCheckbox" />Свободное поле</div>' +
        //        '<div class="DeleteAnswerItem">&#10006;</div><div style="width: 5px;"></div>' +
        //        '<div class="EditAnswer">&#9000;</div>' +
        //        '<div class="ChangeIndex">ID</div>'+
        //        '<input type="hidden" name="IndexAnswer" value="' + (index_answer+1) + '"></div>');
        //})

        // Добавление ответа в вопрос типа Multi
        //$('.BlockQuestionEditor').on("click", ".AddAnswerMulti", function () {
        //    var item_block = $(this).parents(".QuestionBlock");
        //    var index_answer = 0;
        //    if (item_block.find(".AnswerBlock").find(".AnswerItem:not('BaseAnswer')").length != 0) {
        //        index_answer = Number(item_block.find(".AnswerBlock").find(".AnswerItem:not(.BaseAnswer)").last().find('input[name=IndexAnswer]').val());
        //    }
        //    $(this).parents(".QuestionBlock").find(".SaveChangeButton").addClass("NewChangeQuestion");
        //    $(this).parents(".AnswerBlock").append('<div class="AnswerItem NewItem" id=0><div style="margin-right: 15px"><input type="checkbox" disabled/>' +
        //        '</div><div class="IndexAnswer">' + (index_answer + 1) + ') </div>'+
        //        '<div style="width: 80%;" class="TextAnswer TextNewItem">New answer</div>' +
        //        '<div class="FreeArea" style="display: inline-flex; width: 20%; height: 100%;"><input type="checkbox" name="FreeAreaCheckbox" />Свободное поле</div>' +
        //        '<div class="DeleteAnswerItem">&#10006;</div><div style="width: 5px;"></div>' +
        //        '<div class="EditAnswer">&#9000;</div>' +
        //        '<div style="width: 5px;"></div>' +
        //        '<div class="ChangeIndex">ID</div>' +
        //        '<div style="width: 5px;"></div>' +
        //        '<input type="hidden" name="IndexAnswer" value="' + (index_answer + 1) + '"></div>');
        //})

        // Функция добавления свободного текстового поля в вопрос типа Free
        //$('.BlockQuestionEditor').on("click", ".AddAnswerFree", function () {
        //    var item_block = $(this).parents(".QuestionBlock");
        //    var index_answer = 0;
        //    if (item_block.find(".AnswerBlock").find(".AnswerItem:not('BaseAnswer')").length != 0) {
        //        index_answer = Number(item_block.find(".AnswerBlock").find(".AnswerItem:not(.BaseAnswer)").last().find('input[name=IndexAnswer]').val());
        //        console.log("Index Multi >>>> ", item_block.find(".AnswerBlock").find(".AnswerItem:not(.BaseAnswer)").last().find('input[name=IndexAnswer]').val());
        //    }
        //    $(this).parents(".QuestionBlock").find(".SaveChangeButton").addClass("NewChangeQuestion");
        //    $(this).parents(".AnswerBlock").append('<div class="AnswerItem NewItem" id=0><div style="margin-right: 15px"><input type="text" placeholder="Текстовый блок" disabled/>' +
        //        '</div><div style="width: 100%;" class="TextAnswer TextNewItem">New answer</div><div class="DeleteAnswerItem">&#10006;</div><div style="width: 5px;"></div>' +
        //        '<div class="EditAnswer">&#9000;</div>' +
        //        '<div style="width: 5px;"></div>' +
        //        '<div class="ChangeIndex">ID</div>' +
        //        '<div style="width: 5px;"></div>' +
        //        '<input type="hidden" name="IndexAnswer" value="' + (index_answer + 1) + '"></div>');
        //})


    //$('.BlockQuestionEditor').on("mouseenter", ".DeleteAnswerItem", function () {
    //    $(this).addClass("Scaled");
    //})

    //$('.BlockQuestionEditor').on("mouseleave", ".DeleteAnswerItem", function () {
    //    $(this).removeClass("Scaled");
    //})

    //$('.BlockQuestionEditor').on("click", ".DeleteAnswerItem", function () {
    //    var id_answer = Number($(this).parent().attr('id'));
    //    var block = $(this).parents(".AnswerBlock");
    //    var item = $(this).parent();

    //    if (item.hasClass('BaseAnswer')) {
    //        $.post("/Question/deleteAnswerAll", { id_answer: id_answer })
    //            .success(function () {
    //                item.remove();
    //            })
    //    } else {
    //        var index_answer = Number($(this).parents(".AnswerItem").find("input[name=IndexAnswer]").val());
    //        if (!item.hasClass('NewItem')) {
    //            $.post("/Question/deleteAnswer", { id: id_answer })
    //                .success(function () {
    //                    item.remove();
    //                })
    //        } else {
    //            item.remove();
    //        }
    //        ReplaceIndexAnswer(block, index_answer);
    //    }
    //})

    //function ReplaceIndexAnswer(block, index) {
    //    var count = 0;
    //    block.find(".AnswerItem").each(function () {
    //        if (Number($(this).find("input[name=IndexAnswer]").val()) > Number(index)) {
    //            $(this).find("input[name=IndexAnswer]").val((index + count));
    //            count++;
    //        }
    //    })
    //}


    //$('.BlockQuestionEditor').on("mouseenter", ".EditAnswer", function () {
    //    $(this).addClass("Scaled");
    //})

    //$('.BlockQuestionEditor').on("mouseleave", ".EditAnswer", function () {
    //    $(this).removeClass("Scaled");
    //})

    //$('.BlockQuestionEditor').on("click", ".EditAnswer", function () {
    //    var item = $(this).parent().find(".TextAnswer");
    //    $(this).removeClass("EditAnswer").addClass("SaveChangeAnswer").html("&#10004;");
    //    $(document).mouseup(function (event) {
    //        var container = $('.SaveChangeAnswer');
    //        if (container.has(event.target).length === 0 && container.parent().find('.TextAnswer').has(event.target).length === 0) {
    //            var str_tmp = container.parent().find('.TextAnswer').find('input').val();
    //            container.parent().find('.TextAnswer').empty().text(str_tmp);
    //            container.removeClass("SaveChangeAnswer").addClass("EditAnswer");
    //            container.empty().html("&#9000;");
    //        }
    //    });
    //    var width_text = item.width();
    //    var text_str = item.text();
    //    item.empty();
    //    item.append('<input type="text" value="' + text_str + '" style="max-width: 99%; width: 99%;"/>');
    //    item.find('input').focus().select();
    //})

    //$('.BlockQuestionEditor').on("mouseenter", ".SaveChangeAnswer", function () {
    //    $(this).addClass("Scaled");
    //})

    //$('.BlockQuestionEditor').on("mouseleave", ".SaveChangeAnswer", function () {
    //    $(this).removeClass("Scaled");
    //})

    //$('.BlockQuestionEditor').on("mouseenter", ".SaveChangeButton", function () {
    //    $(this).addClass("Scaled");
    //})

    //$('.BlockQuestionEditor').on("mouseleave", ".SaveChangeButton", function () {
    //    $(this).removeClass("Scaled");
    //})

    //Функция сортировки массива
    //function sortFN(prop) {
    //    return function (a, b) {
    //        return a[prop] - b[prop];
    //    }
    //}

    /*
     * Сохранение изменений вопроса
     */
    //$('.BlockQuestionEditor').on("click", ".SaveChangeButton", function () {
    //    var item_block = $(this).parents(".QuestionBlock");
    //    var type_question = Number($(this).parents(".QuestionBlock").find('div[name=QuestionInfo]').find('input[name=questionType]').val());
    //    var id_question = Number($(this).parents(".QuestionBlock").find('div[name=QuestionInfo]').find('input[name=questionInfo]').val());
    //    switch (type_question) {
    //        case 1:
    //            {
    //                var textarea_list = item_block.find(".QuestionText").find('textarea');
    //                var textarea;
    //                $.each(textarea_list, function (i, item) {
    //                    textarea = item;
    //                })
    //                var text_question = sceditor.instance(textarea).val();
    //                var q_query = {
    //                    Id: id_question,
    //                    TypeQuestion: type_question,
    //                    TextQuestion: text_question != "" ? text_question : "empty text",
    //                    ProjectID: $('div[name=ProjectInfo]').find('input[name=project_id]').val(),
    //                    LimitCount: null,
    //                    TypeMassk: null,
    //                    IsKvot: item_block.find('.AnswerBlock').find('.QuotaDiv').find('.QYes').hasClass('QOn') ? true : false,
    //                    IsRotate: item_block.find('.AnswerBlock').find('.RotateDiv').find('.QYes').hasClass('QOn') ? true : false
    //                }

    //                $.post("/Question/Question", q_query)
    //                    .success(function () {
    //                        var list_answer = [];
    //                        var list_base_answer = [];
    //                        item_block.find('.AnswerItem').each(function () {
    //                            if ($(this).hasClass('BaseAnswer')) {
    //                                if (!$(this).hasClass('Existed')) {
    //                                    var query = {
    //                                        AnswerKey: $(this).attr('id'),
    //                                        AnswerType: 2,
    //                                        QuestionID: id_question
    //                                    }
    //                                    list_base_answer.push(query);
    //                                }
    //                            } else {
    //                                if (Number($(this).attr('id')) >= 0) {
    //                                    var query = {
    //                                        Id: Number($(this).attr('id')),
    //                                        AnswerText: $(this).find('.TextAnswer').text(),
    //                                        QuestionID: id_question,
    //                                        Index: Number($(this).find("input[name=IndexAnswer]").val()),
    //                                        isFreeArea: $(this).find("input[name=FreeAreaCheckbox]").prop("checked") ? true : false
    //                                    };
    //                                    list_answer.push(query)
    //                                }
    //                            }
    //                        })
    //                        console.log("Normal answer --- ", list_answer);
    //                        console.log("Base answer ---- ", list_base_answer);
    //                        list_answer.sort(sortFN("Index"));
    //                        $.post("/Question/SaveAnswerRange", { tmp: list_answer })
    //                            .success(function () {
    //                                $.each(list_base_answer, function (i, item) {
    //                                    $.ajax({
    //                                        type: "POST",
    //                                        url: "/Question/setAnswerAll",
    //                                        async: false,
    //                                        data: item,
    //                                        success: function () { }
    //                                    })
    //                                })
    //                                item_block.find('.AnswerItem').each(function () {
    //                                    if ($(this).not('.BaseAnswer')) {
    //                                        $(this).attr('id', -1);
    //                                    }
    //                                })
    //                            })
    //                    })
    //            }
    //            break;
    //        case 2:
    //            {
    //                var textarea_list = item_block.find(".QuestionText").find('textarea');
    //                var textarea;
    //                $.each(textarea_list, function (i, item) {
    //                    textarea = item;
    //                })
    //                var text_question = sceditor.instance(textarea).val();
    //                var q_query = {
    //                    Id: id_question,
    //                    TypeQuestion: type_question,
    //                    TextQuestion: text_question != "" ? text_question : "empty text",
    //                    ProjectID: $('div[name=ProjectInfo]').find('input[name=project_id]').val(),
    //                    LimitCount: isNaN(Number(item_block.find('.LimitCountAnswer').find('.CountLimit').find('input').val())) ? 0 : Number(item_block.find('.LimitCountAnswer').find('.CountLimit').find('input').val()),
    //                    IsKvot: false,
    //                    TypeMassk: null,
    //                    IsRotate: item_block.find('.AnswerBlock').find('.RotateDiv').find('.QYes').hasClass('QOn') ? true : false
    //                }
    //                $.post("/Question/Question", q_query)
    //                    .success(function () {
    //                        var list_answer = [];
    //                        var list_base_answer = [];
    //                        item_block.find('.AnswerItem').each(function () {
    //                            if ($(this).hasClass('BaseAnswer')) {
    //                                var query = {
    //                                    AnswerKey: $(this).attr('id'),
    //                                    AnswerType: 2,
    //                                    QuestionID: id_question
    //                                };
    //                                list_base_answer.push(query);
    //                            } else {
    //                                if (Number($(this).attr('id')) >= 0) {
    //                                    var query = {
    //                                        Id: Number($(this).attr('id')),
    //                                        AnswerText: $(this).find('.TextAnswer').text(),
    //                                        QuestionID: id_question,
    //                                        Index: Number($(this).find("input[name=IndexAnswer]").val()),
    //                                        isFreeArea: false
    //                                    };
    //                                    list_answer.push(query)
    //                                }
    //                            }
    //                        })
    //                        list_answer.sort(sortFN("Index"));
    //                        $.post("/Question/SaveAnswerRange", { tmp: list_answer })
    //                            .success(function () {
    //                                $.each(list_base_answer, function (i, item) {
    //                                    $.ajax({
    //                                        type: "POST",
    //                                        url: "/Question/setAnswerAll",
    //                                        async: false,
    //                                        data: item,
    //                                        success: function () { }
    //                                    })
    //                                })
    //                                item_block.find('.AnswerItem').each(function () {
    //                                    if ($(this).not('.BaseAnswer')) {
    //                                        $(this).attr('id', -1);
    //                                    }
    //                                })
    //                            })
    //                    })
    //            }
    //            break;
    //        case 3:
    //            {
    //                var textarea_list = item_block.find(".QuestionText").find('textarea');
    //                var textarea;
    //                $.each(textarea_list, function (i, item) {
    //                    textarea = item;
    //                })
    //                var text_question = sceditor.instance(textarea).val();
    //                var q_query = {
    //                    Id: id_question,
    //                    TypeQuestion: type_question,
    //                    TextQuestion: text_question != "" ? text_question : "empty text",
    //                    ProjectID: $('div[name=ProjectInfo]').find('input[name=project_id]').val(),
    //                    TypeMassk: isNaN(Number(item_block.find(".MasskDiv").find(".CheckTypeMassk").find("option:checked").val())) ? null : Number(item_block.find(".MasskDiv").find(".CheckTypeMassk").find("option:checked").val()),
    //                    LimitCount: null,
    //                    IsKvot: item_block.find('.AnswerBlock').find('.QuotaDiv').find('.QYes').hasClass('QOn') ? true : false,
    //                    IsRotate: false
    //                }
    //                console.log("Q_Query ---- ", q_query);
    //                if (q_query.TypeMassk != 1) {
    //                    q_query.IsKvot = false;
    //                    if (item_block.find(".PanelOfRange").find(".RangeItem").length > 0) {
    //                        item_block.find(".PanelOfRange").find(".RangeItem").each(function () {
    //                            var block_for_remove = $(this);
    //                            $.post("/Question/DeleteRangePos", { id_range: Number($(this).find("input[name=RangeID]").val()), id_q: id_question })
    //                                .success(function () {
    //                                    block_for_remove.remove();
    //                                })
    //                        })
    //                    }
    //                }
    //                $.post("/Question/Question", q_query)
    //                    .success(function () {
    //                        var list_answer = [];
    //                        item_block.find('.AnswerItem').each(function () {
    //                            if (Number($(this).attr('id')) >= 0) {
    //                                var query = {
    //                                    Id: Number($(this).attr('id')),
    //                                    AnswerText: $(this).find('.TextAnswer').text(),
    //                                    QuestionID: id_question,
    //                                    Index: Number($(this).find("input[name=IndexAnswer]").val()),
    //                                    isFreeArea: false
    //                                };
    //                                list_answer.push(query)
    //                            }
    //                        })
    //                        list_answer.sort(sortFN("Index"));
    //                        console.log("Answer list >>> ", list_answer);
    //                        $.post("/Question/SaveAnswerRange", { tmp: list_answer })
    //                            .success(function () {
    //                                item_block.find('.AnswerItem').each(function () {
    //                                    if ($(this).not('.BaseAnswer')) {
    //                                        $(this).attr('id', -1);
    //                                    }
    //                                })
    //                            });
    //                    })
    //                if (pool_data.DeleteListAnswerSM != undefined) {
    //                    $.post("/Question/DeleteListAnswer", pool_data.DeleteListAnswerSM);
    //                }

    //            }
    //            break;
    //        case 4: {
    //            var textarea_list = item_block.find(".QuestionText").find('textarea');
    //            var textarea;
    //            $.each(textarea_list, function (i, item) {
    //                textarea = item;
    //            })
    //            var text_question = sceditor.instance(textarea).val();
    //            var bind_id_question = null;
    //            if (item_block.find(".BindQuestionDiv").find(".BindYes").hasClass("QOn")) {
    //                bind_id_question = Number(item_block.find(".BlockChain").find("select option:checked").val());
    //            }
    //            var q_query = {
    //                Id: id_question,
    //                TypeQuestion: type_question,
    //                TextQuestion: text_question != "" ? text_question : "empty text",
    //                ProjectID: $('div[name=ProjectInfo]').find('input[name=project_id]').val(),
    //                TypeMassk: null,
    //                LimitCount: null,
    //                IsKvot: false,
    //                IsRotate: false,
    //                Bind: bind_id_question
    //            }
    //            $.post("/Question/Question", q_query)
    //                .error(function () { alert("ERROR") });
    //            var a_query = [];
    //            item_block.find(".AnswerBlock").find(".TableStyle").find("tr.AnswerTableLine").find(".TableColumnText").each(function () {
    //                if (Number($(this).find('div.TextAnswerDiv').attr('id')) >= 0) {
    //                    a_query.push({ AnswerText: $(this).find("div.TextAnswerDiv").text(), Id: $(this).find("div.TextAnswerDiv").attr('id') });
    //                }
    //            })
    //            var count = 1;
    //            $.each(a_query, function (i, item) {
    //                item.Index = count++;
    //                item.QuestionID = id_question;
    //            })
    //            var bl_query = [];
    //            count = 1;
    //            var is_own_index = item_block.find(".OwnIndexDiv").find(".QYes").hasClass("QOn") ? true : false;
    //            item_block.find(".AnswerBlock").find(".TableStyle").find("tr:not(.AnswerTableLine)").each(function () {
    //                console.log("Own Index ----- ", $(this).find("div.InputOwnIndex").find("input[name=OwnIndex]").val());
    //                if (is_own_index == false) {
    //                    if (Number($(this).find("td.TableRowText").find("div.TextTableRowDiv").attr('id')) >= 0) {
    //                        bl_query.push({
    //                            TableRowText: $(this).find("td.TableRowText").find("div.TextTableRowDiv").text(),
    //                            Id: $(this).find("td.TableRowText").find("div.TextTableRowDiv").attr("id")
    //                        });
    //                    }
    //                }
    //                else {
    //                    if (Number($(this).find("td.TableRowText").find("div.TextTableRowDiv").attr('id')) >= 0) {
    //                        bl_query.push({
    //                            TableRowText: $(this).find("td.TableRowText").find("div.TextTableRowDiv").text(),
    //                            Id: $(this).find("td.TableRowText").find("div.TextTableRowDiv").attr("id"),
    //                            IndexRow: Number($(this).find("div.InputOwnIndex").find("input[name=OwnIndex]").val())
    //                        });
    //                    }
    //                }
    //            })
    //            $.each(bl_query, function (i, item) {
    //                if (is_own_index == false) item.IndexRow = count++;
    //                item.TableID = id_question;
    //            })
    //            var query = {
    //                id_q: id_question,
    //                text_row: bl_query,
    //                data: a_query
    //            }
    //            $.post("/Question/setTableRow", query)
    //                .success(function () {
    //                    item_block.find(".AnswerBlock").find(".TableStyle").find("tr.AnswerTableLine").find(".TableColumnText").each(function () {
    //                        $(this).find("div.TextAnswerDiv").attr('id', -1);
    //                    })
    //                    item_block.find(".AnswerBlock").find(".TableStyle").find("tr:not(.AnswerTableLine)").each(function () {
    //                        if (Number($(this).find("td.TableRowText").find("div.TextTableRowDiv").attr('id')) == 0) {
    //                            $(this).find("td.TableRowText").find("div.TextTableRowDiv").attr('id', -1);
    //                        }
    //                    })
    //                });
    //            console.log("Query >>> ", q_query);
    //            console.log("A Query >>> ", a_query);
    //            console.log("BL Query >>> ", bl_query);
    //        }
    //            break;
    //        case 5: {
    //            alert("Text");
    //            var textarea_list = item_block.find(".QuestionText").find('textarea');
    //            var textarea;
    //            $.each(textarea_list, function (i, item) {
    //                textarea = item;
    //            })
    //            var text_question = sceditor.instance(textarea).val();
    //            var q_query = {
    //                Id: id_question,
    //                TypeQuestion: type_question,
    //                TextQuestion: text_question != "" ? text_question : "empty text",
    //                ProjectID: $('div[name=ProjectInfo]').find('input[name=project_id]').val(),
    //                LimitCount: null,
    //                IsKvot: false,
    //                IsRotatr: false
    //            }
    //            $.post("/Question/Question", q_query)
    //                .success(function () {
    //                    $.post("/Question/deleteAllAnswer", { id_question: id_question });
    //                    $.post("/Question/DeleteAllTableRow", { id_q: id_question });
    //                })
    //        }
    //            break;
    //        case 6: {
    //            var textarea_list = item_block.find(".QuestionText").find('textarea');
    //            var textarea;
    //            $.each(textarea_list, function (i, item) {
    //                textarea = item;
    //            })
    //            var text_question = sceditor.instance(textarea).val();
    //            var q_query = {
    //                Id: id_question,
    //                TypeQuestion: type_question,
    //                TextQuestion: text_question != "" ? text_question : "empty text",
    //                ProjectID: $('div[name=ProjectInfo]').find('input[name=project_id]').val(),
    //                TypeMassk: null,
    //                LimitCount: null,
    //                IsKvot: false,
    //                IsRotate: false
    //            }
    //            $.post("/Question/Question", q_query)
    //                .success(function () {
    //                    var panel = item_block.find(".AnswerSettings");
    //                    var l_file;
    //                    $.each(panel.find('input#filter_file'), function (i, item) {
    //                        l_file = item;
    //                    })
    //                    var files = l_file.files;
    //                    if (files.length > 0) {
    //                        if (window.FormData != undefined) {
    //                            var data = new FormData();
    //                            for (var i = 0; i < files.length; i++)
    //                                data.append('file' + i, files[i]);

    //                            $.ajax({
    //                                type: "POST",
    //                                url: "/Group/Upload",
    //                                contentType: false,
    //                                processData: false,
    //                                data: data,
    //                                success: function (server_data) {
    //                                    $.post("/Group/BindIDFilter", { id_p: q_query.ProjectID, id_q: q_query.Id, path: server_data })
    //                                        .success(function () {
    //                                            panel.empty();
    //                                            LoadSettingsFilter(panel, q_query);
    //                                        })
    //                                },
    //                                error: function (xhr, status, p3) {
    //                                    alert(xhr.responseText)
    //                                }
    //                            })
    //                        }
    //                    }
    //                })
    //        }
    //            break;
    //        default:
    //            break;
    //    }
    //    alert("Вопрос сохранен");
    //})
    }

    // Кнопка добавления вопроса в проект
    $('.AddQuestionInProject').click(function (event) {
        if ($('.NewBlockQuestions').find(".Group").length > 0) {
            var offset_x = event.clientX;
            var offset_y = event.clientY;
            console.log("X " + offset_x + " Y " + offset_y);
            var code = "<div class='ShowPanelGroup' style='background-color: #fff; border: 1px solid black; position: fixed; left: " + offset_x + "px; top: " + offset_y + "px; z-index: 1020; display: flex; flex-direction: column;'>"
            code += "<div class='StyleButton AddQuestionInGroup Root' style='background-color: #008dd2; color: #fff;' id='0'>Главная ветвь</div>";
            $(".BlockQuestionEditor").find(".Group").each(function () {
                code += "<div class='StyleButton AddQuestionInGroup' style='background-color: #008dd2; color: #fff;' id='" + $(this).attr('id') + "'>" + $(this).find("div:first").text() + "</div>";
            })
            code += "</div>";
            $('body').append(code);
            var top = $(".ShowPanelGroup").innerHeight();
            $(".ShowPanelGroup").animate({ top: (offset_y - top) + "px" }, 500);
            $(document).mouseup(function (event) {
                var container = $(".ShowPanelGroup");
                if (container.has(event.target).length === 0) {
                    container.remove();
                }
            })
            $(".AddQuestionInGroup").click(function () {
                var query = {
                    GroupID: $(this).attr("id"),
                    ProjectID: $('div[name=ProjectInfo]').find('input[name=project_id]').val()
                }
                var block_group = $(this);
                $.post("/Group/AddGroup", query)
                    .success(function (group_id) {
                        var add_panel = query.GroupID == 0 ? $('.BlockQuestionEditor') : $('.BlockQuestionEditor').find(".Group").filter("#" + block_group.attr("id"));
                        add_panel.append("<div class='QuestionBlock sortable IsChange " + (query.GroupID == 0 ? "MainItem" : "")+"'><div name='QuestionInfo' style='display: none'>" +
                            "<input name='groupInfo' type='hidden' value='" + group_id + "' />" +
                            "<input name='questionInfo' type='hidden' value=0 />" +
                            "<input name='questionType' type='hidden' value=1 />" +
                            "</div>" +
                            "<div class='ShortNameQuestion'><div style='width: 100%;'>New Question</div><div class='EditQuestionName'>&#9000;</div><div class='DeleteQuestion' style='color: #fff;'>&#10006;</div><button class='hidePanel' style='display: inline-flex'>hide</button></div>" +
                            "<div class='QuestionText HideOff NewQuestionBlock IsChange' id=0><textarea id='example' style='width: 80 %; height: 300px; display: none;'></textarea></div>" +
                            "<div class='SettingsPanel'><div class='NameType'>Type</div><div class='WallOfTypes' style='position: relative; z - index: 5; height: 30px; width: 30px'>></div></div>" +
                            "<div class='AnswerBlock HideOff' style='overflow-y: auto;'><div class='AnswerSettings'></div></div>" +
                            "<div class='SaveChange'><div class='SaveChangeButton'>Save</div></div></div>");
                        block_group.parent().remove();
                        var item_tmp = $('.BlockQuestionEditor').find('.NewQuestionBlock').find('textarea');
                        $.each(item_tmp, function (i, item) {
                            sceditor.create(item, {
                                resizeEnabled: false,
                                format: 'xhtml',
                                icons: 'monocons',
                                style: '/Scripts/minified/themes/content/default.min.css',
                                toolbar: 'bold,italic,underline|left,center,right,justify|font,size,color,removeformat|code,quote,horizontalrule|source,maximize'
                            });
                        })
                        $('.BlockQuestionEditor').find('.NewQuestionBlock').removeClass('NewQuestionBlock');
                        $.get('/Group/GetGroupItem', { id_group: group_id })
                            .success(function (data) {
                                console.log("Data group >>> ", data);
                                var id_question = data.QuestionID;
                                var item_block = $('.BlockQuestionEditor').find('.QuestionBlock').filter(".IsChange");
                                item_block.find('.QuestionText').attr("id", id_question);
                                item_block.find("div[name=QuestionInfo]").find('input[name=questionInfo]').val(id_question);
                                item_block.find("div[name=QuestionInfo]").append('<input type="hidden" name="questionType" value="1">');
                                item_block.find(".NameType").text("Single");
                                LoadSettingsSingle(item_block.find(".AnswerSettings"));
                                item_block.removeClass("IsChange");
                                ChangeIndexQuestion();
                            })
                            .error(function () { console.error("Can't load group item") })
                    })
                    .error(function () { alert("Error")});
            })
        } else {
            var query = {
                GroupId: 0,
                ProjectID: $('div[name=ProjectInfo]').find('input[name=project_id]').val()
            }
            console.log("ProjectInfo >>> ", query);
            $.post("/Group/AddGroup", query).
                success(function (group_id) {
                    //var code = "<div class='QuestionBlock sortable IsChange MainItem'><div name='QuestionInfo' style='display: none'>" +
                    //    "<input name='groupInfo' type='hidden' value='" + group_id + "' />" +
                    //    "<input name='questionInfo' type='hidden' value=0 />" +
                    //    "<input name='questionType' type='hidden' value=1 />" +
                    //    "</div>" +
                    //    "<div class='ShortNameQuestion'><div style='width: 100%;'>New Question</div><div class='EditQuestionName'>&#9000;</div><div class='DeleteQuestion' style='color: #fff;'>&#10006;</div><button class='hidePanel' style='display: inline-flex'>hide</button></div>" +
                    //    "<div class='QuestionText HideOff NewQuestionBlock IsChange' id=0><textarea id='example' style='width: 80 %; height: 300px; display: none;'></textarea></div>" +
                    //    "<div class='SettingsPanel'><div class='NameType'>Type</div><div class='WallOfTypes' style='position: relative; z - index: 5; height: 30px; width: 30px'>></div></div>" +
                    //    "<div class='AnswerBlock HideOff' style='overflow-y: auto;'><div class='AnswerSettings'></div></div>" +
                    //    "<div class='SaveChange'><div class='SaveChangeButton'>Save</div></div></div>";
                    var code = "<div class='NewClass' style='width: 100%; height: 30px; background:linear-gradient(90deg, rgba(255,255,255,1) 0%, rgba(111,190,230,1) 100%); border-bottom: 1px solid black; border-right:1px solid black; margin: 1px; display: inline-flex;'>" +
                        "<div style='width:30px;height:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;'>" +
                        "<div style='width:20px;height:20px;background-color:#008dd2;' class='handler'></div>" +
                        "</div>" +
                        "<div class='ShowPanelQuestion' style='width:100%;height:80%;margin:2px;' id='" + group_id + "'>New question" +
                        "<textarea class='QuestionObject' hidden></textarea>" +
                        "</div>" +
                        "</div>";
                    $('.NewBlockQuestions').append(code);
                    //var item_tmp = $('.BlockQuestionEditor').find('.NewQuestionBlock').find('textarea');
                    //$.each(item_tmp, function (i, item) {
                    //    sceditor.create(item, {
                    //        resizeEnabled: false,
                    //        format: 'xhtml',
                    //        icons: 'monocons',
                    //        style: '/Scripts/minified/themes/content/default.min.css',
                    //        toolbar: 'bold,italic,underline|left,center,right,justify|font,size,color,removeformat|code,quote,horizontalrule|source,maximize'
                    //    });
                    //})
                    //$('.BlockQuestionEditor').find('.NewQuestionBlock').removeClass('NewQuestionBlock');
                    //$.get('/Group/GetGroupItem', { id_group: group_id })
                    //    .success(function (data) {
                    //        console.log("Data group >>> ", data);
                    //        var id_question = data.QuestionID;
                    //        var item_block = $('.BlockQuestionEditor').find('.QuestionBlock').filter(".IsChange");
                    //        item_block.find('.QuestionText').attr("id", id_question);
                    //        item_block.find("div[name=QuestionInfo]").find('input[name=questionInfo]').val(id_question);
                    //        item_block.find("div[name=QuestionInfo]").append('<input type="hidden" name="questionType" value="1">');
                    //        item_block.find(".NameType").text("Single");
                    //        LoadSettingsSingle(item_block.find(".AnswerSettings"));
                    //        item_block.removeClass("IsChange");
                    //        ChangeIndexQuestion();
                    //    })
                    //    .error(function () { console.error("Can't load group item") })
                })
        }

    })

    $('.BlockQuestionEditor').on("click", ".EditQuestionName", function () {
        $(this).html('&#10004;');
        $(this).addClass("SaveChangeQuestionName").removeClass('EditQuestionName');
        var item = $(this).parent().find('div:first');
        var str_item = item.text();
        item.empty().append('<input type="text" value="' + str_item + '">');
        item.find('input').css({ "max-width": "100%", "width": "100%" });
    })

    $('.BlockQuestionEditor').on("mouseenter", ".EditQuestionName", function () {
        $(this).addClass('Scaled');
    })

    $('.BlockQuestionEditor').on("mouseleave", ".EditQuestionName", function () {
        $(this).removeClass('Scaled');
    })

    $('.BlockQuestionEditor').on("click", ".SaveChangeQuestionName", function () {
        var item = $(this).parent().find('div:first');
        var str_item = item.find('input').val();
        item.empty().text(str_item);
        $(this).removeClass('SaveChangeQuestionName').addClass('EditQuestionName');
        $(this).html('&#9000;');
    })

    $('.SettingsProject').on("click", ".ShowQuotaPanel", function () {
        ShowQuotaPanel();
        $('.SlideSettings').trigger("click");
    })

    $('.SettingsProject').on("click", ".ShowBaseAnswerPanel", function () {
        ShowBaseAnswerPanel();
        $('.SlideSettings').trigger("click");
    })

    // Добавление блока групп в анкету
    $('.SettingsProject').on("click", ".AddGroupInProject", function () {
        var max_index_group = 1;
        $('.NewBlockQuestions').find(".NewGroup").each(function () {
            if (max_index_group < Number($(this).find('.ShowPanelGroupText').attr('id'))) {
                max_index_group = Number($(this).find('.ShowPanelGroupText').attr('id'));
            }
        })
        $.post("/Group/AddNewGroup", { id_p: $('div[name=ProjectInfo]').find('input[name=project_id]').val() })
            .success(function (index_group) {
                $('.NewBlockQuestions').append("<div class='NewGroup MainItem' style='width: 100%; height: auto; background:linear-gradient(90deg, rgba(255,255,255,1) 0%, rgba(50,50,50,1) 100%); border-bottom: 1px solid black; border-right:1px solid black; margin: 1px; display: block;'>" +
                    "<div style='display: flex;'>" +
                    "<div style='width:30px;height:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;'>" +
                    "<div style='width:20px;height:20px;background-color:#008dd2;' class='handler'></div>" +
                    "</div>" +
                    "<div class='ShowPanelGroupText' style='width:100%;height:80%;margin:2px;' id='" + index_group + "'>Группа" + index_group +
                    "<textarea class='QuestionObject' hidden></textarea>" +
                    "</div>" +
                    "</div>" +
                    "<div class='BlockQuestionGroup sortable-ul' style='height:auto; width:100%; background-color:#81c784; display: block; padding-left: 50px;'></div>" +
                    "</div>")
                ChangeIndexQuestion();
                EnableSortable();
            })
            .error(function () { alert("Ошибка создания группы") });

    })

    // Удаление блока группы из анкеты
    $('.SettingsProject').on("click", ".DeleteGroupInProject", function (event) {
        var offset_x = event.clientX;
        var offset_y = event.clientY;
        console.log("X " + offset_x + " Y " + offset_y);
        var code = "<div class='ShowPanelGroup' style='background-color: #fff; border: 1px solid black; position: fixed; left: " + offset_x + "px; top: " + offset_y + "px; z-index: 1020; display: flex; flex-direction: column;'>"
        $(".NewBlockQuestions").find(".NewGroup").each(function () {
            code += "<div class='StyleButton DeleteGroup' style='background-color: #008dd2; color: #fff;' id='" + $(this).find('.ShowPanelGroupText').attr('id') + "'>" + $(this).find('.ShowPanelGroupText').text() + "</div>";
        })
        code += "</div>";
        $('body').append(code);
        var top = $(".ShowPanelGroup").innerHeight();
        $(".ShowPanelGroup").animate({ top: (offset_y - top) + "px" }, 500);
        $(document).mouseup(function (event) {
            var container = $(".ShowPanelGroup");
            if (container.has(event.target).length === 0) {
                container.remove();
            }
        })
        $('.DeleteGroup').click(function () {
            var group_id = $(this).attr("id");
            $(this).parent().remove();
            $.post("/Group/DeleteGroup", { id_group: group_id, id_project: $("div[name=ProjectInfo]").find("input[name=project_id]").val() })
                .success(function () {
                    $(".NewBlockQuestions").find(".ShowPanelGroupText").filter("#" + group_id).parents('.NewGroup').remove();
                   // ChangeIndexQuestion();
                })
        })
    })

    function ChangeIndexQuestion() {
        var count = 1;
        var count_group = 1;
        var list_id_questtion = [];
        $('.NewBlockQuestions').find(".MainItem").each(function () {
            if ($(this).hasClass("NewClass")) {
                list_id_questtion.push($(this).find('.ShowPanelQuestion').attr('id'))
                //$(this).find(".ShortNameQuestion").find("div:first").text("Вопрос " + count);
                count++;
            } else if ($(this).hasClass("NewGroup")) {
                list_id_questtion.push(-1 * Number($(this).find('.ShowPanelGroupText').attr("id")));
                //$(this).find("div:first").text("Группа " + count_group++);
                $(this).find(".NewClass").each(function () {
                    list_id_questtion.push($(this).find('.ShowPanelQuestion').attr('id'));
                    //$(this).find(".ShortNameQuestion").find("div:first").text("Вопрос " + count);
                    count++;
                })
            }
        })
        $.post("/Group/ChangeIndexQuestion", { new_set: list_id_questtion, id_p: $('div[name=ProjectInfo]').find('input[name=project_id]').val() });
        console.log("List --- > ", list_id_questtion);
    }

    {
        //$('.BlockQuestionEditor').on("click", ".SetBindGroup", function (event) {
        //    var question_id = Number($(this).parents(".QuestionBlock").find("input[name=questionInfo]").val());
        //    var answer_id = Number($(this).parents(".AnswerItem").attr('id'));
        //    var offset_x = $(this).offset().left;
        //    var offset_y = $(this).offset().top;
        //    var height = $(this).height();
        //    var x = event.clientX;
        //    var y = event.clientY;
        //    var block_change = $(this);
        //    var code = "";
        //    $('.BlockQuestionEditor').find(".Group").each(function () {
        //        code += "<div class='StyleButton SetBindGroupButton' style='background-color: #008dd2; color: #fff;' id='" + $(this).attr('id') + "'>" + $(this).find("div:first").text() + "</div>";
        //    })
        //    $('body').append("<div style='width: 100px; height: auto; position: absolute; left: " + offset_x + "px; top: " + offset_y + "px; z-index: 2000;' class='RemovePanel'>" +
        //        code +
        //        "</div>");
        //    var cont_group = $('.RemovePanel');
        //    cont_group.css({
        //        top: (offset_y - (cont_group.height() - height)) + "px",
        //        opacity: 0
        //    })

        //    $('.SetBindGroupButton').click(function () {
        //        var group_id = $(this).attr("id");
        //        $.post("/Group/SetBindGroup", { id_q: question_id, id_a: answer_id, id_g: group_id })
        //            .success(function () {
        //                block_change.after('<div class= "SetBindGroup" style = "width: 100px; background-color: #81c784;" > Группа ' + group_id + '<div class= "RemoveBindGroup StyleButton" style = "background-color: #f44336; width: 30px;" >&#10006;</div></div>');
        //                block_change.remove();
        //                cont_group.remove();
        //            });
        //    })

        //    cont_group.animate({ left: (cont_group.offset().left - cont_group.width()) + "px", opacity: 1 }, 200);
        //    $(document).mouseup(function (event) {
        //        var cont = $('.RemovePanel');
        //        if (cont.has(event.target).length === 0) {
        //          //  alert();
        //            cont.remove();
        //        }
        //    })
        //})

        //$('.BlockQuestionEditor').on("click", ".RemoveBindGroup", function () {
        //    var answer_id = Number($(this).parents(".AnswerItem").attr('id'));
        //    var question_id = Number($(this).parents(".QuestionBlock").find("input[name=questionInfo]").val());
        //    var block = $(this).parent();
        //    var block_item = $(this).parents(".AnswerItem");
        //    var block_change = $(this);
        //    $.post("/Group/DeleteBindGroup", { id_q: question_id, id_a: answer_id })
        //        .success(function () {
        //            block.after('<div class="SetBindGroup StyleButton" style="width: 30px; background-color: #81c784; font-size: 20px;">&infin;</div>');
        //            block.remove();
        //        })
        //})


        // Вызов функции экспорта анкеты в текстовый файл
        //$('.SettingsProject').on("click", ".ExportFormToDoc", function () {
        //    $('.SlideSettings').trigger("click");
        //    export2Doc($(".BlockQuestionEditor"), $('div.title').text());
        //})
        ////End NEW BLOCK


        //$('.drop span').mouseenter(function () {
        //    if ($(this).parent().attr('name') != "checked") {
        //        $(this).css('background-color', '#aaa');
        //    }
        //});
        //$('.drop span').mouseleave(function () {
        //    if ($(this).parent().attr('name') != 'checked')
        //        $(this).css('background-color', '#fff');
        //});



        //$(".ul-dropfree").find("li:has(ul)").prepend('<div class="drop"></div>');
        //$(".ul-dropfree div.drop").click(function () {
        //    if ($(this).nextAll("ul").css('display') == 'none') {
        //        $(this).nextAll("ul").slideDown(400);
        //        $(this).css({ 'background-position': "-11px 0" });
        //    } else {
        //        $(this).nextAll("ul").slideUp(400);
        //        $(this).css({ 'background-position': "0 0" });
        //    }
        //});
        //$(".ul-dropfree").find("ul").slideUp(400).parents("li").children("div.drop").css({ 'background-position': "0 0" });



        //$(document).ready(function () { // вся мaгия пoсле зaгрузки стрaницы
        //    $('.PreLoader').hide();
        //    var list_group_block = {};
        //    var list_div_group = [];
        //    $.get("/Group/GetListGroup", { id_p: $('input[name=project_id]').val() })
        //        .success(function (server_data) {
        //            $.each(server_data, function (i, item) {
        //                var mas_tmp = [];

        //                if (item.Group == null || item.Group>0) {
        //                    mas_tmp.push(item);
        //                    if (list_group_block[item.GroupID] != null) {
        //                        list_group_block[item.GroupID].push(item);
        //                    } else {
        //                        list_group_block[item.GroupID] = mas_tmp;
        //                    }
        //                }

        //            })

        //            var code = '<ul class="ul-treefree ul-dropfree tree_view">'
        //            $.each(list_group_block[0], function (i, item) {
        //                if (item.Group == null) {
        //                    code += '<li class="question_view quest" id=' + item.QuestionID + '><span>' + item.GroupName + '</span></li>';
        //                } else {
        //                    var index = item.Group;
        //                    code += '<li class="group" id=' + item.Group + '><span>' + item.GroupName + '</span><ul class="group_element" id=' + item.Group + '>';
        //                    if (list_group_block[index] != null) {
        //                        $.each(list_group_block[index], function (i, item) {
        //                            code += '<li class="question_view quest" id=' + item.QuestionID + '><span>' + item.GroupName + '</span></li>';
        //                        });
        //                    }
        //                    code += '</ul ></li >';
        //                }
        //            });
        //            code += '</ul>';
        //            $('div.drop').append(code);
        //            $('.drop span').mouseenter(function () {
        //                if ($(this).parent().attr('name') != "checked") {
        //                    $(this).css('background-color', '#aaa');
        //                }
        //            });
        //            $('.drop span').mouseleave(function () {
        //                if ($(this).parent().attr('name') != 'checked')
        //                    $(this).css('background-color', '#fff');
        //            });
        //            $(".ul-dropfree").find("li:has(ul)").prepend('<div class="drop"></div>');
        //            $(".ul-dropfree div.drop").click(function () {
        //                if ($(this).nextAll("ul").css('display') == 'none') {
        //                    $(this).nextAll("ul").slideDown(400);
        //                    $(this).css({ 'background-position': "-11px 0" });
        //                } else {
        //                    $(this).nextAll("ul").slideUp(400);
        //                    $(this).css({ 'background-position': "0 0" });
        //                }
        //            });

        //            $('li.quest').bind('click', function () {
        //               // $(this).unbind('click');
        //                loadEditor($(this));
        //            });
        //          //  $(".ul-dropfree").find("ul").slideUp(400).parents("li").children("div.drop").css({ 'background-position': "0 0" });
        //            $('ul.tree_view').sortable({
        //                start: function (event, ui) {
        //                    $('ul.tree_view').find('ul.group_element').each(function () {

        //                        if ($(this).text().length == 0) {
        //                            $(this).append('<li class="tmp_item" style="background-color: grey; width: 100px; height: 20px;"></li>');
        //                        }
        //                    })
        //                },
        //                stop: function (event, ui) {
        //                    var count = 1;
        //                    var count_group = 1;
        //                    var list_id_question = [];
        //                    $('.tree_view').find('.tmp_item').each(function () { $(this).remove(); })
        //                    $('ul.tree_view li').each(function () {
        //                        if ($(this).hasClass('group')) {
        //                            $(this).find('span').text("Группа " + count_group);
        //                            count_group++;
        //                            list_id_question.push(-1*Number($(this).attr('id')))
        //                        }
        //                        else {
        //                            $(this).find('span').text("Вопрос " + count);
        //                            count++;
        //                            list_id_question.push(Number($(this).attr('id')));
        //                        }
        //                    })
        //                    var change_item = ui.item;
        //                    if (ui.item.parent().hasClass('group_element')) {
        //                        if (ui.item.hasClass('group')) {
        //                            $('ul.tree_view').sortable("cancel");
        //                        } else {
        //                            $.post("/Group/ChangeGroup", { id_q: ui.item.attr('id'), id_g: ui.item.parent().attr('id') });
        //                        }
        //                    }
        //                    $.post("/Group/ChangeIndexQuestion", { new_set: list_id_question, id_p: $('input[name=project_id]').val() });
        //                },
        //                placeholder: 'emptySpace',
        //                delay: 400,
        //                connectWith: '.group_element'
        //            });

        //            $('li.group ul').sortable({
        //                stop: function (event, ui) {
        //                    var list_id_question = [];
        //                    if (ui.item.parent().hasClass('group_element')) {
        //                        $.post("/Group/ChangeGroup", { id_q: ui.item.attr('id'), id_g: ui.item.parent().attr('id') });
        //                    }
        //                    if (ui.item.parent().hasClass('tree_view')) {
        //                        $.post("/Group/ChangeGroup", { id_q: ui.item.attr('id'), id_g: 0 });
        //                    }
        //                    changeIndexGroup();
        //                    if (ui.item.parent().hasClass('tree_view')) {
        //                        $.post("/Group/ChangeGroup", { id_q: ui.item.attr('id'), id_g: 0 });
        //                    }
        //                },
        //                placeholder: 'emptySpace',
        //                connectWith: '.tree_view'
        //            });
        //            $('ul.tree_view').disableSelection();
        //        });

        //    $('#add_question, .save_question').click(function (event) { // лoвим клик пo ссылки с id="go"
        //        event.preventDefault(); // выключaем стaндaртную рoль элементa
        //        $('#overlay').fadeIn(400, // снaчaлa плaвнo пoкaзывaем темную пoдлoжку
        //            function () { // пoсле выпoлнения предъидущей aнимaции
        //                $('#modal_form')
        //                    .css('display', 'block') // убирaем у мoдaльнoгo oкнa display: none;
        //                    .animate({ opacity: 1, top: '50%' }, 200); // плaвнo прибaвляем прoзрaчнoсть oднoвременнo сo съезжaнием вниз
        //            });
        //    });
        //    /* Зaкрытие мoдaльнoгo oкнa, тут делaем тo же сaмoе нo в oбрaтнoм пoрядке */
        //    $('#modal_close, #overlay, .add_group').click(function () { // лoвим клик пo крестику или пoдлoжке
        //        $('#modal_form')
        //            .animate({ opacity: 0, top: '45%' }, 200,  // плaвнo меняем прoзрaчнoсть нa 0 и oднoвременнo двигaем oкнo вверх
        //            function () { // пoсле aнимaции
        //                $(this).css('display', 'none'); // делaем ему display: none;
        //                $('#overlay').fadeOut(400); // скрывaем пoдлoжку
        //            }
        //            );
        //    });
        //});


    }
    var countClick = 0;

    //$.get('/Question/getListAnswerBase')
    //    .success(function (data) {
    //        list_answer_base = data;
    //    });

    function loadEditor(tmp) {
        $('.tree_view').find('li[name=checked]').removeAttr('name').find('span').css('background-color', '#fff');
        tmp.find('span').css('background-color', '#72afff');
        tmp.attr('name', 'checked');
        $(".editor").load("/Group/Editor?Id=" + tmp.attr('id'));
    }

    function AddNewGroup() {
        $.post("/Group/AddNewGroup", { id_p: $('input[name=project_id]').val() })
            .success(function () {
                $("#Tables").load("/Group/Manager?id_project=" + @ViewBag.ProjectID);
            });
    }

    function DeleteGroup() {
        var code = '<div class="background_screen" style="position: fixed; top: 0; left:0; width: 100%; height: 100%; background-color: rgba(155,155,155,0.5); z-index:9999; ">';
        code += '<div style="position: relative; width: 10%; height: auto; background: red; top: 50%; left: 50%;">';
        code += '<select class="check_group">'
        $('li.group').each(function () {
            code += '<option value="' + $(this).attr('id') + '">' + $(this).find('span:first').text()+'</option>'
        })
        code += '</select>';
        code += '<button class="delete_group">Delete</button>'
        code += '</div></div>';
        $('body').append(code);

        $('button.delete_group').click(function () {
           // alert("1212");
            var id_group = $('select.check_group option:checked').val();
          //  alert(id_group);
            $.post("/Group/DeleteGroup", { id_group: id_group, id_project: $('input[name=project_id]').val() })
                .success(function () {
                    $('div.background_screen').remove();
                     $("#Tables").load("/Group/Manager?id_project=" + $('input[name=project_id]').val());
                })
        })
    }

    function changeIndexGroup() {
        var count = 1;
        var count_group = 1;
        var list_id_question = [];
        $('ul.tree_view li').each(function () {
            if ($(this).hasClass('group')) {
                $(this).find('span').text("Группа " + count_group);
                count_group++;
                list_id_question.push(-1*Number($(this).attr('id')))
            }
            else {
                $(this).find('span').text("Вопрос " + count);
                count++;
                list_id_question.push(Number($(this).attr('id')))
            }
        })
        if ($('ul.tree_view').text().length != 0) {
            $.post("/Group/ChangeIndexQuestion", { new_set: list_id_question, id_p: $('input[name=project_id]').val() });
        }
    }

    function ShowQuotaPanel() {
        $('.PreLoader').show();
        var id_project = Number($('input[name=project_id]').val());
        $('.BlockWall').show();
        $('.HiddenPanelQuota').fadeIn(500);
        $('.ButtonClose').fadeIn(500);
        $('.HiddenPanelQuota').append('<div class="ForDelete" style="padding: 15px;"></div>')
        setTimeout(function () {
            $('.ForDelete').load("/Home/Kvot?id_p=" + id_project);
        }, 500);
    }

    function CloseClick() {
        $('.HiddenPanelQuota').find('div.ForDelete').remove();
        $('.HiddenPanelQuota').fadeOut(200);
        $('.ButtonClose').fadeOut(200);
        $('.BlockWall').hide();
    }

    function ShowLoopPanel() {
        $('.PreLoader').show();
        var id_project = Number($('input[name=project_id]').val());
        $('.BlockWall').show();
        $('.HiddenPanelQuota').fadeIn(500);
        $('.ButtonClose').fadeIn(500);
        $('.HiddenPanelQuota').append('<div class="ForDelete" style="padding: 15px;"></div>')
        setTimeout(function () {
            $('.ForDelete').load("/Question/Loop?id_p=" + id_project);
        }, 500);
    }

    function ShowBaseAnswerPanel() {
        $('.PreLoader').show();
        $('.BlockWall').show();
        $('.HiddenPanelQuota').fadeIn(500);
        $('.ButtonClose').fadeIn(500);
        if ($('.HiddenPanelQuota').find('.ForDelete').length > 0) $('.HiddenPanelQuota').find('.ForDelete').remove();
        $('.HiddenPanelQuota').append('<div class="ForDelete" style="padding: 15px;"></div>');
        setTimeout(function () {
            $('.ForDelete').load("/Question/BaseAnswer");
        }, 500);
    }
</script>